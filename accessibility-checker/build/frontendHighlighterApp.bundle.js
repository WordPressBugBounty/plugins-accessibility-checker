/*! For license information please see frontendHighlighterApp.bundle.js.LICENSE.txt */
(()=>{"use strict";(()=>{const t=Math.min,e=Math.max,n=Math.round,i=Math.floor,o=t=>({x:t,y:t});function s(t){return t.split("-")[0]}function r(t){return t.split("-")[1]}function a(t){return"y"===t?"height":"width"}function c(t){return["top","bottom"].includes(s(t))?"y":"x"}function l(t){return"x"===c(t)?"y":"x"}function d(t){return{...t,top:t.y,left:t.x,right:t.x+t.width,bottom:t.y+t.height}}function u(t,e,n){let{reference:i,floating:o}=t;const d=c(e),u=l(e),h=a(u),p=s(e),f="y"===d,g=i.x+i.width/2-o.width/2,m=i.y+i.height/2-o.height/2,v=i[h]/2-o[h]/2;let y;switch(p){case"top":y={x:g,y:i.y-o.height};break;case"bottom":y={x:g,y:i.y+i.height};break;case"right":y={x:i.x+i.width,y:m};break;case"left":y={x:i.x-o.width,y:m};break;default:y={x:i.x,y:i.y}}switch(r(e)){case"start":y[u]-=v*(n&&f?-1:1);break;case"end":y[u]+=v*(n&&f?-1:1)}return y}function h(t){return g(t)?(t.nodeName||"").toLowerCase():"#document"}function p(t){var e;return(null==t||null==(e=t.ownerDocument)?void 0:e.defaultView)||window}function f(t){var e;return null==(e=(g(t)?t.ownerDocument:t.document)||window.document)?void 0:e.documentElement}function g(t){return t instanceof Node||t instanceof p(t).Node}function m(t){return t instanceof Element||t instanceof p(t).Element}function v(t){return t instanceof HTMLElement||t instanceof p(t).HTMLElement}function y(t){return"undefined"!=typeof ShadowRoot&&(t instanceof ShadowRoot||t instanceof p(t).ShadowRoot)}function b(t){const{overflow:e,overflowX:n,overflowY:i,display:o}=_(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(o)}function w(t){return["table","td","th"].includes(h(t))}function x(t){const e=S(),n=_(t);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!e&&!!n.backdropFilter&&"none"!==n.backdropFilter||!e&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((t=>(n.willChange||"").includes(t)))||["paint","layout","strict","content"].some((t=>(n.contain||"").includes(t)))}function S(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function E(t){return["html","body","#document"].includes(h(t))}function _(t){return p(t).getComputedStyle(t)}function k(t){return m(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.pageXOffset,scrollTop:t.pageYOffset}}function T(t){if("html"===h(t))return t;const e=t.assignedSlot||t.parentNode||y(t)&&t.host||f(t);return y(e)?e.host:e}function C(t){const e=T(t);return E(e)?t.ownerDocument?t.ownerDocument.body:t.body:v(e)&&b(e)?e:C(e)}function L(t,e,n){var i;void 0===e&&(e=[]),void 0===n&&(n=!0);const o=C(t),s=o===(null==(i=t.ownerDocument)?void 0:i.body),r=p(o);return s?e.concat(r,r.visualViewport||[],b(o)?o:[],r.frameElement&&n?L(r.frameElement):[]):e.concat(o,L(o,[],n))}function N(t){const e=_(t);let i=parseFloat(e.width)||0,o=parseFloat(e.height)||0;const s=v(t),r=s?t.offsetWidth:i,a=s?t.offsetHeight:o,c=n(i)!==r||n(o)!==a;return c&&(i=r,o=a),{width:i,height:o,$:c}}function A(t){return m(t)?t:t.contextElement}function F(t){const e=A(t);if(!v(e))return o(1);const i=e.getBoundingClientRect(),{width:s,height:r,$:a}=N(e);let c=(a?n(i.width):i.width)/s,l=(a?n(i.height):i.height)/r;return c&&Number.isFinite(c)||(c=1),l&&Number.isFinite(l)||(l=1),{x:c,y:l}}const I=o(0);function O(t){const e=p(t);return S()&&e.visualViewport?{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}:I}function D(t,e,n,i){void 0===e&&(e=!1),void 0===n&&(n=!1);const s=t.getBoundingClientRect(),r=A(t);let a=o(1);e&&(i?m(i)&&(a=F(i)):a=F(t));const c=function(t,e,n){return void 0===e&&(e=!1),!(!n||e&&n!==p(t))&&e}(r,n,i)?O(r):o(0);let l=(s.left+c.x)/a.x,u=(s.top+c.y)/a.y,h=s.width/a.x,f=s.height/a.y;if(r){const t=p(r),e=i&&m(i)?p(i):i;let n=t.frameElement;for(;n&&i&&e!==t;){const t=F(n),e=n.getBoundingClientRect(),i=_(n),o=e.left+(n.clientLeft+parseFloat(i.paddingLeft))*t.x,s=e.top+(n.clientTop+parseFloat(i.paddingTop))*t.y;l*=t.x,u*=t.y,h*=t.x,f*=t.y,l+=o,u+=s,n=p(n).frameElement}}return d({width:h,height:f,x:l,y:u})}function P(t){return D(f(t)).left+k(t).scrollLeft}function R(t,n,i){let s;if("viewport"===n)s=function(t,e){const n=p(t),i=f(t),o=n.visualViewport;let s=i.clientWidth,r=i.clientHeight,a=0,c=0;if(o){s=o.width,r=o.height;const t=S();(!t||t&&"fixed"===e)&&(a=o.offsetLeft,c=o.offsetTop)}return{width:s,height:r,x:a,y:c}}(t,i);else if("document"===n)s=function(t){const n=f(t),i=k(t),o=t.ownerDocument.body,s=e(n.scrollWidth,n.clientWidth,o.scrollWidth,o.clientWidth),r=e(n.scrollHeight,n.clientHeight,o.scrollHeight,o.clientHeight);let a=-i.scrollLeft+P(t);const c=-i.scrollTop;return"rtl"===_(o).direction&&(a+=e(n.clientWidth,o.clientWidth)-s),{width:s,height:r,x:a,y:c}}(f(t));else if(m(n))s=function(t,e){const n=D(t,!0,"fixed"===e),i=n.top+t.clientTop,s=n.left+t.clientLeft,r=v(t)?F(t):o(1);return{width:t.clientWidth*r.x,height:t.clientHeight*r.y,x:s*r.x,y:i*r.y}}(n,i);else{const e=O(t);s={...n,x:n.x-e.x,y:n.y-e.y}}return d(s)}function B(t,e){const n=T(t);return!(n===e||!m(n)||E(n))&&("fixed"===_(n).position||B(n,e))}function H(t,e,n){const i=v(e),s=f(e),r="fixed"===n,a=D(t,!0,r,e);let c={scrollLeft:0,scrollTop:0};const l=o(0);if(i||!i&&!r)if(("body"!==h(e)||b(s))&&(c=k(e)),i){const t=D(e,!0,r,e);l.x=t.x+e.clientLeft,l.y=t.y+e.clientTop}else s&&(l.x=P(s));return{x:a.left+c.scrollLeft-l.x,y:a.top+c.scrollTop-l.y,width:a.width,height:a.height}}function q(t,e){return v(t)&&"fixed"!==_(t).position?e?e(t):t.offsetParent:null}function M(t,e){const n=p(t);if(!v(t))return n;let i=q(t,e);for(;i&&w(i)&&"static"===_(i).position;)i=q(i,e);return i&&("html"===h(i)||"body"===h(i)&&"static"===_(i).position&&!x(i))?n:i||function(t){let e=T(t);for(;v(e)&&!E(e);){if(x(e))return e;e=T(e)}return null}(t)||n}const j={convertOffsetParentRelativeRectToViewportRelativeRect:function(t){let{rect:e,offsetParent:n,strategy:i}=t;const s=v(n),r=f(n);if(n===r)return e;let a={scrollLeft:0,scrollTop:0},c=o(1);const l=o(0);if((s||!s&&"fixed"!==i)&&(("body"!==h(n)||b(r))&&(a=k(n)),v(n))){const t=D(n);c=F(n),l.x=t.x+n.clientLeft,l.y=t.y+n.clientTop}return{width:e.width*c.x,height:e.height*c.y,x:e.x*c.x-a.scrollLeft*c.x+l.x,y:e.y*c.y-a.scrollTop*c.y+l.y}},getDocumentElement:f,getClippingRect:function(n){let{element:i,boundary:o,rootBoundary:s,strategy:r}=n;const a=[..."clippingAncestors"===o?function(t,e){const n=e.get(t);if(n)return n;let i=L(t,[],!1).filter((t=>m(t)&&"body"!==h(t))),o=null;const s="fixed"===_(t).position;let r=s?T(t):t;for(;m(r)&&!E(r);){const e=_(r),n=x(r);n||"fixed"!==e.position||(o=null),(s?!n&&!o:!n&&"static"===e.position&&o&&["absolute","fixed"].includes(o.position)||b(r)&&!n&&B(t,r))?i=i.filter((t=>t!==r)):o=e,r=T(r)}return e.set(t,i),i}(i,this._c):[].concat(o),s],c=a[0],l=a.reduce(((n,o)=>{const s=R(i,o,r);return n.top=e(s.top,n.top),n.right=t(s.right,n.right),n.bottom=t(s.bottom,n.bottom),n.left=e(s.left,n.left),n}),R(i,c,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:M,getElementRects:async function(t){let{reference:e,floating:n,strategy:i}=t;const o=this.getOffsetParent||M,s=this.getDimensions;return{reference:H(e,await o(n),i),floating:{x:0,y:0,...await s(n)}}},getClientRects:function(t){return Array.from(t.getClientRects())},getDimensions:function(t){return N(t)},getScale:F,isElement:m,isRTL:function(t){return"rtl"===_(t).direction}};function W(n,o,s,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:l="function"==typeof ResizeObserver,layoutShift:d="function"==typeof IntersectionObserver,animationFrame:u=!1}=r,h=A(n),p=a||c?[...h?L(h):[],...L(o)]:[];p.forEach((t=>{a&&t.addEventListener("scroll",s,{passive:!0}),c&&t.addEventListener("resize",s)}));const g=h&&d?function(n,o){let s,r=null;const a=f(n);function c(){clearTimeout(s),r&&r.disconnect(),r=null}return function l(d,u){void 0===d&&(d=!1),void 0===u&&(u=1),c();const{left:h,top:p,width:f,height:g}=n.getBoundingClientRect();if(d||o(),!f||!g)return;const m={rootMargin:-i(p)+"px "+-i(a.clientWidth-(h+f))+"px "+-i(a.clientHeight-(p+g))+"px "+-i(h)+"px",threshold:e(0,t(1,u))||1};let v=!0;function y(t){const e=t[0].intersectionRatio;if(e!==u){if(!v)return l();e?l(!1,e):s=setTimeout((()=>{l(!1,1e-7)}),100)}v=!1}try{r=new IntersectionObserver(y,{...m,root:a.ownerDocument})}catch(t){r=new IntersectionObserver(y,m)}r.observe(n)}(!0),c}(h,s):null;let m,v=-1,y=null;l&&(y=new ResizeObserver((t=>{let[e]=t;e&&e.target===h&&y&&(y.unobserve(o),cancelAnimationFrame(v),v=requestAnimationFrame((()=>{y&&y.observe(o)}))),s()})),h&&!u&&y.observe(h),y.observe(o));let b=u?D(n):null;return u&&function t(){const e=D(n);!b||e.x===b.x&&e.y===b.y&&e.width===b.width&&e.height===b.height||s();b=e,m=requestAnimationFrame(t)}(),s(),()=>{p.forEach((t=>{a&&t.removeEventListener("scroll",s),c&&t.removeEventListener("resize",s)})),g&&g(),y&&y.disconnect(),y=null,u&&cancelAnimationFrame(m)}}const $=(t,e,n)=>{const i=new Map,o={platform:j,...n},s={...o.platform,_c:i};return(async(t,e,n)=>{const{placement:i="bottom",strategy:o="absolute",middleware:s=[],platform:r}=n,a=s.filter(Boolean),c=await(null==r.isRTL?void 0:r.isRTL(e));let l=await r.getElementRects({reference:t,floating:e,strategy:o}),{x:d,y:h}=u(l,i,c),p=i,f={},g=0;for(let n=0;n<a.length;n++){const{name:s,fn:m}=a[n],{x:v,y,data:b,reset:w}=await m({x:d,y:h,initialPlacement:i,placement:p,strategy:o,middlewareData:f,rects:l,platform:r,elements:{reference:t,floating:e}});d=null!=v?v:d,h=null!=y?y:h,f={...f,[s]:{...f[s],...b}},w&&g<=50&&(g++,"object"==typeof w&&(w.placement&&(p=w.placement),w.rects&&(l=!0===w.rects?await r.getElementRects({reference:t,floating:e,strategy:o}):w.rects),({x:d,y:h}=u(l,p,c))),n=-1)}return{x:d,y:h,placement:p,strategy:o,middlewareData:f}})(t,e,{...o,platform:s})};var G=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],U=G.join(","),V="undefined"==typeof Element,X=V?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,z=!V&&Element.prototype.getRootNode?function(t){var e;return null==t||null===(e=t.getRootNode)||void 0===e?void 0:e.call(t)}:function(t){return null==t?void 0:t.ownerDocument},Y=function t(e,n){var i;void 0===n&&(n=!0);var o=null==e||null===(i=e.getAttribute)||void 0===i?void 0:i.call(e,"inert");return""===o||"true"===o||n&&e&&t(e.parentNode)},K=function(t,e,n){if(Y(t))return[];var i=Array.prototype.slice.apply(t.querySelectorAll(U));return e&&X.call(t,U)&&i.unshift(t),i=i.filter(n)},J=function t(e,n,i){for(var o=[],s=Array.from(e);s.length;){var r=s.shift();if(!Y(r,!1))if("SLOT"===r.tagName){var a=r.assignedElements(),c=t(a.length?a:r.children,!0,i);i.flatten?o.push.apply(o,c):o.push({scopeParent:r,candidates:c})}else{X.call(r,U)&&i.filter(r)&&(n||!e.includes(r))&&o.push(r);var l=r.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(r),d=!Y(l,!1)&&(!i.shadowRootFilter||i.shadowRootFilter(r));if(l&&d){var u=t(!0===l?r.children:l.children,!0,i);i.flatten?o.push.apply(o,u):o.push({scopeParent:r,candidates:u})}else s.unshift.apply(s,r.children)}}return o},Q=function(t){return!isNaN(parseInt(t.getAttribute("tabindex"),10))},Z=function(t){if(!t)throw new Error("No node provided");return t.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(t.tagName)||function(t){var e,n=null==t||null===(e=t.getAttribute)||void 0===e?void 0:e.call(t,"contenteditable");return""===n||"true"===n}(t))&&!Q(t)?0:t.tabIndex},tt=function(t,e){return t.tabIndex===e.tabIndex?t.documentOrder-e.documentOrder:t.tabIndex-e.tabIndex},et=function(t){return"INPUT"===t.tagName},nt=function(t){return function(t){return et(t)&&"radio"===t.type}(t)&&!function(t){if(!t.name)return!0;var e,n=t.form||z(t),i=function(t){return n.querySelectorAll('input[type="radio"][name="'+t+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)e=i(window.CSS.escape(t.name));else try{e=i(t.name)}catch(t){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",t.message),!1}var o=function(t,e){for(var n=0;n<t.length;n++)if(t[n].checked&&t[n].form===e)return t[n]}(e,t.form);return!o||o===t}(t)},it=function(t){var e=t.getBoundingClientRect(),n=e.width,i=e.height;return 0===n&&0===i},ot=function(t,e){var n=e.displayCheck,i=e.getShadowRoot;if("hidden"===getComputedStyle(t).visibility)return!0;var o=X.call(t,"details>summary:first-of-type")?t.parentElement:t;if(X.call(o,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return it(t)}else{if("function"==typeof i){for(var s=t;t;){var r=t.parentElement,a=z(t);if(r&&!r.shadowRoot&&!0===i(r))return it(t);t=t.assignedSlot?t.assignedSlot:r||a===t.ownerDocument?r:a.host}t=s}if(function(t){var e,n,i,o,s=t&&z(t),r=null===(e=s)||void 0===e?void 0:e.host,a=!1;if(s&&s!==t)for(a=!!(null!==(n=r)&&void 0!==n&&null!==(i=n.ownerDocument)&&void 0!==i&&i.contains(r)||null!=t&&null!==(o=t.ownerDocument)&&void 0!==o&&o.contains(t));!a&&r;){var c,l,d;a=!(null===(l=r=null===(c=s=z(r))||void 0===c?void 0:c.host)||void 0===l||null===(d=l.ownerDocument)||void 0===d||!d.contains(r))}return a}(t))return!t.getClientRects().length;if("legacy-full"!==n)return!0}return!1},st=function(t,e){return!(e.disabled||Y(e)||function(t){return et(t)&&"hidden"===t.type}(e)||ot(e,t)||function(t){return"DETAILS"===t.tagName&&Array.prototype.slice.apply(t.children).some((function(t){return"SUMMARY"===t.tagName}))}(e)||function(t){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(t.tagName))for(var e=t.parentElement;e;){if("FIELDSET"===e.tagName&&e.disabled){for(var n=0;n<e.children.length;n++){var i=e.children.item(n);if("LEGEND"===i.tagName)return!!X.call(e,"fieldset[disabled] *")||!i.contains(t)}return!0}e=e.parentElement}return!1}(e))},rt=function(t,e){return!(nt(e)||Z(e)<0||!st(t,e))},at=function(t){var e=parseInt(t.getAttribute("tabindex"),10);return!!(isNaN(e)||e>=0)},ct=function t(e){var n=[],i=[];return e.forEach((function(e,o){var s=!!e.scopeParent,r=s?e.scopeParent:e,a=function(t,e){var n=Z(t);return n<0&&e&&!Q(t)?0:n}(r,s),c=s?t(e.candidates):r;0===a?s?n.push.apply(n,c):n.push(r):i.push({documentOrder:o,tabIndex:a,item:e,isScope:s,content:c})})),i.sort(tt).reduce((function(t,e){return e.isScope?t.push.apply(t,e.content):t.push(e.content),t}),[]).concat(n)},lt=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==X.call(t,U)&&rt(e,t)},dt=G.concat("iframe").join(","),ut=function(t,e){if(e=e||{},!t)throw new Error("No node provided");return!1!==X.call(t,dt)&&st(e,t)};function ht(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function pt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ht(Object(n),!0).forEach((function(e){ft(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ht(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function ft(t,e,n){return(e=function(t){var e=function(t,e){if("object"!=typeof t||null===t)return t;var n=t[Symbol.toPrimitive];if(void 0!==n){var i=n.call(t,e||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}(t,"string");return"symbol"==typeof e?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var gt=function(t,e){if(t.length>0){var n=t[t.length-1];n!==e&&n.pause()}var i=t.indexOf(e);-1===i||t.splice(i,1),t.push(e)},mt=function(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1),t.length>0&&t[t.length-1].unpause()},vt=function(t){return"Tab"===(null==t?void 0:t.key)||9===(null==t?void 0:t.keyCode)},yt=function(t){return vt(t)&&!t.shiftKey},bt=function(t){return vt(t)&&t.shiftKey},wt=function(t){return setTimeout(t,0)},xt=function(t,e){var n=-1;return t.every((function(t,i){return!e(t)||(n=i,!1)})),n},St=function(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return"function"==typeof t?t.apply(void 0,n):t},Et=function(t){return t.target.shadowRoot&&"function"==typeof t.composedPath?t.composedPath()[0]:t.target},_t=[],kt=function(t,e){var n,i=(null==e?void 0:e.document)||document,o=(null==e?void 0:e.trapStack)||_t,s=pt({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:yt,isKeyBackward:bt},e),r={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a=function(t,e,n){return t&&void 0!==t[e]?t[e]:s[n||e]},c=function(t,e){var n="function"==typeof(null==e?void 0:e.composedPath)?e.composedPath():void 0;return r.containerGroups.findIndex((function(e){var i=e.container,o=e.tabbableNodes;return i.contains(t)||(null==n?void 0:n.includes(i))||o.find((function(e){return e===t}))}))},l=function(t){var e=s[t];if("function"==typeof e){for(var n=arguments.length,o=new Array(n>1?n-1:0),r=1;r<n;r++)o[r-1]=arguments[r];e=e.apply(void 0,o)}if(!0===e&&(e=void 0),!e){if(void 0===e||!1===e)return e;throw new Error("`".concat(t,"` was specified but was not a node, or did not return a node"))}var a=e;if("string"==typeof e&&!(a=i.querySelector(e)))throw new Error("`".concat(t,"` as selector refers to no known node"));return a},d=function(){var t=l("initialFocus");if(!1===t)return!1;if(void 0===t||!ut(t,s.tabbableOptions))if(c(i.activeElement)>=0)t=i.activeElement;else{var e=r.tabbableGroups[0];t=e&&e.firstTabbableNode||l("fallbackFocus")}if(!t)throw new Error("Your focus-trap needs to have at least one focusable element");return t},u=function(){if(r.containerGroups=r.containers.map((function(t){var e=function(t,e){var n;return n=(e=e||{}).getShadowRoot?J([t],e.includeContainer,{filter:rt.bind(null,e),flatten:!1,getShadowRoot:e.getShadowRoot,shadowRootFilter:at}):K(t,e.includeContainer,rt.bind(null,e)),ct(n)}(t,s.tabbableOptions),n=function(t,e){return(e=e||{}).getShadowRoot?J([t],e.includeContainer,{filter:st.bind(null,e),flatten:!0,getShadowRoot:e.getShadowRoot}):K(t,e.includeContainer,st.bind(null,e))}(t,s.tabbableOptions),i=e.length>0?e[0]:void 0,o=e.length>0?e[e.length-1]:void 0,r=n.find((function(t){return lt(t)})),a=n.slice().reverse().find((function(t){return lt(t)})),c=!!e.find((function(t){return Z(t)>0}));return{container:t,tabbableNodes:e,focusableNodes:n,posTabIndexesFound:c,firstTabbableNode:i,lastTabbableNode:o,firstDomTabbableNode:r,lastDomTabbableNode:a,nextTabbableNode:function(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],o=e.indexOf(t);return o<0?i?n.slice(n.indexOf(t)+1).find((function(t){return lt(t)})):n.slice(0,n.indexOf(t)).reverse().find((function(t){return lt(t)})):e[o+(i?1:-1)]}}})),r.tabbableGroups=r.containerGroups.filter((function(t){return t.tabbableNodes.length>0})),r.tabbableGroups.length<=0&&!l("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(r.containerGroups.find((function(t){return t.posTabIndexesFound}))&&r.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},h=function t(e){var n=e.activeElement;if(n)return n.shadowRoot&&null!==n.shadowRoot.activeElement?t(n.shadowRoot):n},p=function t(e){!1!==e&&e!==h(document)&&(e&&e.focus?(e.focus({preventScroll:!!s.preventScroll}),r.mostRecentlyFocusedNode=e,function(t){return t.tagName&&"input"===t.tagName.toLowerCase()&&"function"==typeof t.select}(e)&&e.select()):t(d()))},f=function(t){var e=l("setReturnFocus",t);return e||!1!==e&&t},g=function(t){var e=t.target,n=t.event,i=t.isBackward,o=void 0!==i&&i;e=e||Et(n),u();var a=null;if(r.tabbableGroups.length>0){var d=c(e,n),h=d>=0?r.containerGroups[d]:void 0;if(d<0)a=o?r.tabbableGroups[r.tabbableGroups.length-1].lastTabbableNode:r.tabbableGroups[0].firstTabbableNode;else if(o){var p=xt(r.tabbableGroups,(function(t){var n=t.firstTabbableNode;return e===n}));if(p<0&&(h.container===e||ut(e,s.tabbableOptions)&&!lt(e,s.tabbableOptions)&&!h.nextTabbableNode(e,!1))&&(p=d),p>=0){var f=0===p?r.tabbableGroups.length-1:p-1,g=r.tabbableGroups[f];a=Z(e)>=0?g.lastTabbableNode:g.lastDomTabbableNode}else vt(n)||(a=h.nextTabbableNode(e,!1))}else{var m=xt(r.tabbableGroups,(function(t){var n=t.lastTabbableNode;return e===n}));if(m<0&&(h.container===e||ut(e,s.tabbableOptions)&&!lt(e,s.tabbableOptions)&&!h.nextTabbableNode(e))&&(m=d),m>=0){var v=m===r.tabbableGroups.length-1?0:m+1,y=r.tabbableGroups[v];a=Z(e)>=0?y.firstTabbableNode:y.firstDomTabbableNode}else vt(n)||(a=h.nextTabbableNode(e))}}else a=l("fallbackFocus");return a},m=function(t){var e=Et(t);c(e,t)>=0||(St(s.clickOutsideDeactivates,t)?n.deactivate({returnFocus:s.returnFocusOnDeactivate}):St(s.allowOutsideClick,t)||t.preventDefault())},v=function(t){var e=Et(t),n=c(e,t)>=0;if(n||e instanceof Document)n&&(r.mostRecentlyFocusedNode=e);else{var i;t.stopImmediatePropagation();var o=!0;if(r.mostRecentlyFocusedNode)if(Z(r.mostRecentlyFocusedNode)>0){var a=c(r.mostRecentlyFocusedNode),l=r.containerGroups[a].tabbableNodes;if(l.length>0){var u=l.findIndex((function(t){return t===r.mostRecentlyFocusedNode}));u>=0&&(s.isKeyForward(r.recentNavEvent)?u+1<l.length&&(i=l[u+1],o=!1):u-1>=0&&(i=l[u-1],o=!1))}}else r.containerGroups.some((function(t){return t.tabbableNodes.some((function(t){return Z(t)>0}))}))||(o=!1);else o=!1;o&&(i=g({target:r.mostRecentlyFocusedNode,isBackward:s.isKeyBackward(r.recentNavEvent)})),p(i||(r.mostRecentlyFocusedNode||d()))}r.recentNavEvent=void 0},y=function(t){if(!(e=t,"Escape"!==(null==e?void 0:e.key)&&"Esc"!==(null==e?void 0:e.key)&&27!==(null==e?void 0:e.keyCode)||!1===St(s.escapeDeactivates,t)))return t.preventDefault(),void n.deactivate();var e;(s.isKeyForward(t)||s.isKeyBackward(t))&&function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.recentNavEvent=t;var n=g({event:t,isBackward:e});n&&(vt(t)&&t.preventDefault(),p(n))}(t,s.isKeyBackward(t))},b=function(t){var e=Et(t);c(e,t)>=0||St(s.clickOutsideDeactivates,t)||St(s.allowOutsideClick,t)||(t.preventDefault(),t.stopImmediatePropagation())},w=function(){if(r.active)return gt(o,n),r.delayInitialFocusTimer=s.delayInitialFocus?wt((function(){p(d())})):p(d()),i.addEventListener("focusin",v,!0),i.addEventListener("mousedown",m,{capture:!0,passive:!1}),i.addEventListener("touchstart",m,{capture:!0,passive:!1}),i.addEventListener("click",b,{capture:!0,passive:!1}),i.addEventListener("keydown",y,{capture:!0,passive:!1}),n},x=function(){if(r.active)return i.removeEventListener("focusin",v,!0),i.removeEventListener("mousedown",m,!0),i.removeEventListener("touchstart",m,!0),i.removeEventListener("click",b,!0),i.removeEventListener("keydown",y,!0),n},S="undefined"!=typeof window&&"MutationObserver"in window?new MutationObserver((function(t){t.some((function(t){return Array.from(t.removedNodes).some((function(t){return t===r.mostRecentlyFocusedNode}))}))&&p(d())})):void 0,E=function(){S&&(S.disconnect(),r.active&&!r.paused&&r.containers.map((function(t){S.observe(t,{subtree:!0,childList:!0})})))};return(n={get active(){return r.active},get paused(){return r.paused},activate:function(t){if(r.active)return this;var e=a(t,"onActivate"),n=a(t,"onPostActivate"),o=a(t,"checkCanFocusTrap");o||u(),r.active=!0,r.paused=!1,r.nodeFocusedBeforeActivation=i.activeElement,null==e||e();var s=function(){o&&u(),w(),E(),null==n||n()};return o?(o(r.containers.concat()).then(s,s),this):(s(),this)},deactivate:function(t){if(!r.active)return this;var e=pt({onDeactivate:s.onDeactivate,onPostDeactivate:s.onPostDeactivate,checkCanReturnFocus:s.checkCanReturnFocus},t);clearTimeout(r.delayInitialFocusTimer),r.delayInitialFocusTimer=void 0,x(),r.active=!1,r.paused=!1,E(),mt(o,n);var i=a(e,"onDeactivate"),c=a(e,"onPostDeactivate"),l=a(e,"checkCanReturnFocus"),d=a(e,"returnFocus","returnFocusOnDeactivate");null==i||i();var u=function(){wt((function(){d&&p(f(r.nodeFocusedBeforeActivation)),null==c||c()}))};return d&&l?(l(f(r.nodeFocusedBeforeActivation)).then(u,u),this):(u(),this)},pause:function(t){if(r.paused||!r.active)return this;var e=a(t,"onPause"),n=a(t,"onPostPause");return r.paused=!0,null==e||e(),x(),E(),null==n||n(),this},unpause:function(t){if(!r.paused||!r.active)return this;var e=a(t,"onUnpause"),n=a(t,"onPostUnpause");return r.paused=!1,null==e||e(),u(),w(),E(),null==n||n(),this},updateContainerElements:function(t){var e=[].concat(t).filter(Boolean);return r.containers=e.map((function(t){return"string"==typeof t?i.querySelector(t):t})),r.active&&u(),E(),this}}).updateContainerElements(t),n};const Tt=wp.i18n,Ct=t=>{const e={};t.querySelectorAll("input, select, textarea").forEach((t=>{t.addEventListener("change",(()=>{document.dispatchEvent(new CustomEvent("edac-fix-settings-change"))}));const n=t.getAttribute("data-fix-slug");if(n)if(void 0===e[n]&&(e[n]={}),"checkbox"===t.type)e[n][t.name]=t.checked;else e[n][t.name]=t.value}));const n=t.querySelectorAll("button");n.forEach((t=>{t.disabled=!0})),t.classList.add("edac-fix-settings--saving");const i=t.querySelector("[aria-live]");i&&(i.innerText=(0,Tt.__)("Saving...","accessibility-checker")),fetch("/wp-json/edac/v1/fixes/update/",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.edacSettings?.nonce??window.edac_script_vars?.restNonce??window.edacFrontendHighlighterApp?.restNonce},body:JSON.stringify(e)}).then((e=>{if(t.classList.remove("edac-fix-settings--saving"),n.forEach((t=>{t.disabled=!1})),e.ok){if(t.classList.remove("edac-fix-settings--saved--error"),t.classList.add("edac-fix-settings--saved--success"),i){const t=window?.edacFrontendHighlighterApp?.editorLink||window?.edac_script_vars?.editorLink;t?i.innerHTML=(0,Tt.sprintf)((0,Tt.__)("Settings saved successfully. You must %svisit the editor%s and save the post to rescan and remove fixed issues from Accessibility Checker reports.","accessibility-checker"),`<a href="${t}">`,"</a>"):i.innerText=(0,Tt.__)("Settings saved successfully.","accessibility-checker")}}else t.classList.add("edac-fix-settings--saved--error"),t.querySelector("[aria-live]").innerText=(0,Tt.__)("Saving failed.","accessibility-checker");document.dispatchEvent(new CustomEvent("edac-fix-settings-saved",{detail:{success:e.ok}}))}))};let Lt=null;const Nt=new Event("edac-fixes-modal-closed",{bubbles:!0}),At=[],Ft=()=>{(()=>{const t=document.createElement("div");t.id="edac-fixes-modal",t.classList.add("edac-fixes-modal"),t.setAttribute("role","dialog"),t.setAttribute("aria-modal","false"),t.setAttribute("aria-labelledby","edac-fixes-modal-title"),t.innerHTML=`\n\t\t<div class="edac-fixes-modal__content">\n\t\t\t<div class="edac-fixes-modal__header">\n\t\t\t\t<h2 id="edac-fixes-modal-title">${(0,Tt.__)("Fix Settings","accessibility-checker")}</h2>\n\t\t\t\t<button class="edac-fixes-modal__close" aria-label="${(0,Tt.__)("Close fixes modal","accessibility-checker")}">\n\t\t\t\t\t<span class="dashicons dashicons-no-alt"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="edac-fixes-modal__body">\n\t\t\t</div>\n\t\t</div>\n\t`;const e=document.createElement("div");e.classList.add("edac-fixes-modal__overlay"),e.setAttribute("aria-hidden","true"),e.setAttribute("tabindex","-1"),document.body.appendChild(e),document.body.appendChild(t)})(),document.querySelector(".edac-fixes-modal__close").addEventListener("click",(()=>{It()})),document.addEventListener("keydown",(t=>{document.activeElement.closest(".edac-fixes-modal")&&"Escape"===t.key&&It()}))},It=()=>{const t=document.getElementById("edac-fixes-modal");t.classList.remove("edac-fixes-modal--open"),t.setAttribute("aria-hidden","true"),t.setAttribute("aria-modal","false");const e=t.querySelector(".edac-fix-settings--clone--wrapper").children[0];document.querySelector(".edac-fix-settings--origin-placeholder").replaceWith(e);Array.from(document.body.children).forEach((t=>{"true"===t.getAttribute("data-hidden-by-modal")&&(t.removeAttribute("aria-hidden","false"),t.removeAttribute("data-hidden-by-modal","false"))})),document.body.classList.remove("edac-fixes-modal--open"),Lt&&Lt.focus(),Ot(),document.dispatchEvent(Nt)},Ot=()=>{At.forEach((({field:t,changeListener:e})=>{t.removeEventListener("change",e)}))};var Dt,Pt=function(){return Pt=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++)for(var o in e=arguments[n])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},Pt.apply(this,arguments)},Rt=function(){function t(t){this.options=t,this.listeners={}}return t.prototype.on=function(t,e){var n=this.listeners[t]||[];this.listeners[t]=n.concat([e])},t.prototype.triggerEvent=function(t,e){var n=this;(this.listeners[t]||[]).forEach((function(t){return t({target:n,event:e})}))},t}();!function(t){t[t.Add=0]="Add",t[t.Remove=1]="Remove"}(Dt||(Dt={}));var Bt,Ht=function(){function t(){this.notifications=[]}return t.prototype.push=function(t){this.notifications.push(t),this.updateFn(t,Dt.Add,this.notifications)},t.prototype.splice=function(t,e){var n=this.notifications.splice(t,e)[0];return this.updateFn(n,Dt.Remove,this.notifications),n},t.prototype.indexOf=function(t){return this.notifications.indexOf(t)},t.prototype.onUpdate=function(t){this.updateFn=t},t}();!function(t){t.Dismiss="dismiss",t.Click="click"}(Bt||(Bt={}));var qt={types:[{type:"success",className:"notyf__toast--success",backgroundColor:"#3dc763",icon:{className:"notyf__icon--success",tagName:"i"}},{type:"error",className:"notyf__toast--error",backgroundColor:"#ed3d3d",icon:{className:"notyf__icon--error",tagName:"i"}}],duration:2e3,ripple:!0,position:{x:"right",y:"bottom"},dismissible:!1},Mt=function(){function t(){this.notifications=[],this.events={},this.X_POSITION_FLEX_MAP={left:"flex-start",center:"center",right:"flex-end"},this.Y_POSITION_FLEX_MAP={top:"flex-start",center:"center",bottom:"flex-end"};var t=document.createDocumentFragment(),e=this._createHTMLElement({tagName:"div",className:"notyf"});t.appendChild(e),document.body.appendChild(t),this.container=e,this.animationEndEventName=this._getAnimationEndEventName(),this._createA11yContainer()}return t.prototype.on=function(t,e){var n;this.events=Pt(Pt({},this.events),((n={})[t]=e,n))},t.prototype.update=function(t,e){e===Dt.Add?this.addNotification(t):e===Dt.Remove&&this.removeNotification(t)},t.prototype.removeNotification=function(t){var e,n,i=this,o=this._popRenderedNotification(t);o&&((e=o.node).classList.add("notyf__toast--disappear"),e.addEventListener(this.animationEndEventName,n=function(t){t.target===e&&(e.removeEventListener(i.animationEndEventName,n),i.container.removeChild(e))}))},t.prototype.addNotification=function(t){var e=this._renderNotification(t);this.notifications.push({notification:t,node:e}),this._announce(t.options.message||"Notification")},t.prototype._renderNotification=function(t){var e,n=this._buildNotificationCard(t),i=t.options.className;return i&&(e=n.classList).add.apply(e,i.split(" ")),this.container.appendChild(n),n},t.prototype._popRenderedNotification=function(t){for(var e=-1,n=0;n<this.notifications.length&&e<0;n++)this.notifications[n].notification===t&&(e=n);if(-1!==e)return this.notifications.splice(e,1)[0]},t.prototype.getXPosition=function(t){var e;return(null===(e=null==t?void 0:t.position)||void 0===e?void 0:e.x)||"right"},t.prototype.getYPosition=function(t){var e;return(null===(e=null==t?void 0:t.position)||void 0===e?void 0:e.y)||"bottom"},t.prototype.adjustContainerAlignment=function(t){var e=this.X_POSITION_FLEX_MAP[this.getXPosition(t)],n=this.Y_POSITION_FLEX_MAP[this.getYPosition(t)],i=this.container.style;i.setProperty("justify-content",n),i.setProperty("align-items",e)},t.prototype._buildNotificationCard=function(t){var e=this,n=t.options,i=n.icon;this.adjustContainerAlignment(n);var o=this._createHTMLElement({tagName:"div",className:"notyf__toast"}),s=this._createHTMLElement({tagName:"div",className:"notyf__ripple"}),r=this._createHTMLElement({tagName:"div",className:"notyf__wrapper"}),a=this._createHTMLElement({tagName:"div",className:"notyf__message"});a.innerHTML=n.message||"";var c=n.background||n.backgroundColor;if(i){var l=this._createHTMLElement({tagName:"div",className:"notyf__icon"});if(("string"==typeof i||i instanceof String)&&(l.innerHTML=new String(i).valueOf()),"object"==typeof i){var d=i.tagName,u=void 0===d?"i":d,h=i.className,p=i.text,f=i.color,g=void 0===f?c:f,m=this._createHTMLElement({tagName:u,className:h,text:p});g&&(m.style.color=g),l.appendChild(m)}r.appendChild(l)}if(r.appendChild(a),o.appendChild(r),c&&(n.ripple?(s.style.background=c,o.appendChild(s)):o.style.background=c),n.dismissible){var v=this._createHTMLElement({tagName:"div",className:"notyf__dismiss"}),y=this._createHTMLElement({tagName:"button",className:"notyf__dismiss-btn"});v.appendChild(y),r.appendChild(v),o.classList.add("notyf__toast--dismissible"),y.addEventListener("click",(function(n){var i,o;null===(o=(i=e.events)[Bt.Dismiss])||void 0===o||o.call(i,{target:t,event:n}),n.stopPropagation()}))}o.addEventListener("click",(function(n){var i,o;return null===(o=(i=e.events)[Bt.Click])||void 0===o?void 0:o.call(i,{target:t,event:n})}));var b="top"===this.getYPosition(n)?"upper":"lower";return o.classList.add("notyf__toast--"+b),o},t.prototype._createHTMLElement=function(t){var e=t.tagName,n=t.className,i=t.text,o=document.createElement(e);return n&&(o.className=n),o.textContent=i||null,o},t.prototype._createA11yContainer=function(){var t=this._createHTMLElement({tagName:"div",className:"notyf-announcer"});t.setAttribute("aria-atomic","true"),t.setAttribute("aria-live","polite"),t.style.border="0",t.style.clip="rect(0 0 0 0)",t.style.height="1px",t.style.margin="-1px",t.style.overflow="hidden",t.style.padding="0",t.style.position="absolute",t.style.width="1px",t.style.outline="0",document.body.appendChild(t),this.a11yContainer=t},t.prototype._announce=function(t){var e=this;this.a11yContainer.textContent="",setTimeout((function(){e.a11yContainer.textContent=t}),100)},t.prototype._getAnimationEndEventName=function(){var t,e=document.createElement("_fake"),n={MozTransition:"animationend",OTransition:"oAnimationEnd",WebkitTransition:"webkitAnimationEnd",transition:"animationend"};for(t in n)if(void 0!==e.style[t])return n[t];return"animationend"},t}();!function(){function t(t){var e=this;this.dismiss=this._removeNotification,this.notifications=new Ht,this.view=new Mt;var n=this.registerTypes(t);this.options=Pt(Pt({},qt),t),this.options.types=n,this.notifications.onUpdate((function(t,n){return e.view.update(t,n)})),this.view.on(Bt.Dismiss,(function(t){var n=t.target,i=t.event;e._removeNotification(n),n.triggerEvent(Bt.Dismiss,i)})),this.view.on(Bt.Click,(function(t){var e=t.target,n=t.event;return e.triggerEvent(Bt.Click,n)}))}t.prototype.error=function(t){var e=this.normalizeOptions("error",t);return this.open(e)},t.prototype.success=function(t){var e=this.normalizeOptions("success",t);return this.open(e)},t.prototype.open=function(t){var e=this.options.types.find((function(e){return e.type===t.type}))||{},n=Pt(Pt({},e),t);this.assignProps(["ripple","position","dismissible"],n);var i=new Rt(n);return this._pushNotification(i),i},t.prototype.dismissAll=function(){for(;this.notifications.splice(0,1););},t.prototype.assignProps=function(t,e){var n=this;t.forEach((function(t){e[t]=null==e[t]?n.options[t]:e[t]}))},t.prototype._pushNotification=function(t){var e=this;this.notifications.push(t);var n=void 0!==t.options.duration?t.options.duration:this.options.duration;n&&setTimeout((function(){return e._removeNotification(t)}),n)},t.prototype._removeNotification=function(t){var e=this.notifications.indexOf(t);-1!==e&&this.notifications.splice(e,1)},t.prototype.normalizeOptions=function(t,e){var n={type:t};return"string"==typeof e?n.message=e:"object"==typeof e&&(n=Pt(Pt({},n),e)),n},t.prototype.registerTypes=function(t){var e=(t&&t.types||[]).slice();return qt.types.map((function(t){var n=-1;e.forEach((function(e,i){e.type===t.type&&(n=i)}));var i=-1!==n?e.splice(n,1)[0]:{};return Pt(Pt({},t),i)})).concat(e)}}();class jt{constructor(t={}){this.settings={showIgnored:!1,...t},this._scanAttempted=!1,this._isRescanning=!1,this.highlightPanel=this.addHighlightPanel(),this.nextButton=document.querySelector("#edac-highlight-next"),this.previousButton=document.querySelector("#edac-highlight-previous"),this.panelToggle=document.querySelector("#edac-highlight-panel-toggle"),this.closePanel=document.querySelector("#edac-highlight-panel-controls-close"),this.panelDescription=document.querySelector("#edac-highlight-panel-description"),this.panelControls=document.querySelector("#edac-highlight-panel-controls"),this.descriptionCloseButton=document.querySelector(".edac-highlight-panel-description-close"),this.issues=null,this.fixes=null,this.currentButtonIndex=null,this.urlParameter=this.get_url_parameter("edac"),this.landmarkParameter=this.get_url_parameter("edac_landmark"),this.currentIssueStatus=null,this.tooltips=[],this.panelControlsFocusTrap=kt("#"+this.panelControls.id,{clickOutsideDeactivates:!0,escapeDeactivates:()=>{this.panelClose()}}),this.panelDescriptionFocusTrap=kt("#"+this.panelDescription.id,{clickOutsideDeactivates:!0,escapeDeactivates:()=>{this.descriptionClose()}}),this.disableStylesButton=document.querySelector("#edac-highlight-disable-styles"),this.rescanButton=document.querySelector("#edac-highlight-rescan"),this.clearIssuesButton=document.querySelector("#edac-highlight-clear-issues"),this.stylesDisabled=!1,this.originalCss=[],this.init()}init(){this.nextButton.addEventListener("click",(()=>{this.highlightFocusNext(),this.focusTrapDescription()})),this.previousButton.addEventListener("click",(()=>{this.highlightFocusPrevious(),this.focusTrapDescription()})),this.panelToggle.addEventListener("click",(()=>{this.panelOpen(),this.focusTrapControls()})),this.closePanel.addEventListener("click",(()=>{this.panelClose(),this.panelControlsFocusTrap.deactivate(),this.panelDescriptionFocusTrap.deactivate(),this.enableStyles()})),this.descriptionCloseButton.addEventListener("click",(()=>this.descriptionClose())),this.disableStylesButton.addEventListener("click",(()=>{this.stylesDisabled?this.enableStyles():this.disableStyles()})),this.rescanButton&&this.rescanButton.addEventListener("click",(()=>{this.rescanPage()})),this.clearIssuesButton&&this.clearIssuesButton.addEventListener("click",(()=>{this.clearIssues()})),this.urlParameter?this.panelOpen(this.urlParameter):this.landmarkParameter&&this.highlightLandmark(this.landmarkParameter)}findElement(t,e){let n=t.object;const i=(new DOMParser).parseFromString(n,"text/html").body.firstElementChild;i&&(n=i.outerHTML);const o=document.body.querySelectorAll("*");for(const i of o)if(i.outerHTML.replace(/\W/g,"")===n.replace(/\W/g,"")){const n=this.addTooltip(i,t,e,this.issues.length);return this.issues[e].tooltip=n.tooltip,this.tooltips.push(n),i}return null}highlightAjax(){const t=this;return new Promise((function(e,n){const i=new XMLHttpRequest,o=edacFrontendHighlighterApp.ajaxurl+"?action=edac_frontend_highlight_ajax&post_id="+edacFrontendHighlighterApp.postID+"&nonce="+edacFrontendHighlighterApp.nonce;t.showWait(!0),i.open("GET",o),i.onload=function(){if(200===i.status){t.showWait(!1);const o=JSON.parse(i.responseText);if(!0===o.success){const n=JSON.parse(o.data);t.settings.showIgnored?e({issues:n.issues,fixes:n.fixes}):e({issues:n.issues.filter((e=>null!==e.rule_type&&(e.id===t.urlParameter||"ignored"!==e.rule_type))),fixes:n.fixes})}else t._scanAttempted||-3!==o.data?.[0]?.code?e({issues:[],fixes:[]}):(t._scanAttempted=!0,t.kickoffScan(),setTimeout((()=>{t.highlightAjax().then(e).catch(n)}),5e3))}else t.showWait(!1),n({status:i.status,statusText:i.statusText})},i.onerror=function(){t.showWait(!1),n({status:i.status,statusText:i.statusText})},i.send()}))}showWait(t=!0){t?document.querySelector("body").classList.add("edac-app-wait"):document.querySelector("body").classList.remove("edac-app-wait")}removeHighlightButtons(){this.tooltips.forEach((t=>{t.tooltip.removeEventListener("click",t.listeners.onClick),t.listeners.cleanup()}));document.querySelectorAll(".edac-highlight-btn").forEach((t=>{t.remove()})),this.removeLandmarkLabels()}addTooltip(t,e,n,i){const o=document.createElement("button");o.classList="edac-highlight-btn edac-highlight-btn-"+e.rule_type,o.setAttribute("aria-label",`Open details for ${e.rule_title}, ${n+1} of ${i}`),o.setAttribute("aria-expanded","false"),o.setAttribute("aria-haspopup","dialog"),o.dataset.id=e.id;const s=t=>{const e=t.currentTarget.dataset.id;this.showIssue(e)};o.addEventListener("click",s),document.body.append(o),o.dataset.targetElement=(t=>{let e=0;if(0===t.length)return e;for(let n=0;n<t.length;n++)e=32*e-e+t.charCodeAt(n),e=Math.floor(e);return Math.abs(e)})(t.outerHTML),o.dataset.creationOrder=Date.now()+Math.random();const r=W(t,o,(function(){const e=o.dataset.targetElement,n=parseFloat(o.dataset.creationOrder),i=Array.from(document.querySelectorAll(".edac-highlight-btn")).filter((t=>t!==o&&t.dataset.targetElement===e&&parseFloat(t.dataset.creationOrder)<n)).length;$(t,o,{placement:"top-start",middleware:[]}).then((({x:e,y:n,middlewareData:s,placement:r})=>{const a=t.getBoundingClientRect(),c=void 0===t.offsetHeight?0:t.offsetHeight,l=void 0===t.offsetWidth?0:t.offsetWidth,d=void 0===o.offsetHeight?0:o.offsetHeight,u=void 0===o.offsetWidth?0:o.offsetWidth;let h=0;const p=i*(u+5);d<=.8*c&&(h=d),u>=.8*l&&(h=0),a.left<u&&(e=0),a.left>window.screen&&(e=window.screen.width-u),a.top<d&&(n=0),Object.assign(o.style,{left:`${e+p}px`,top:`${n+h}px`})}))}),{ancestorScroll:!0,ancestorResize:!0,elementResize:!0,layoutShift:!0,animationFrame:!0});return{element:t,tooltip:o,listeners:{onClick:s,cleanup:r}}}addHighlightPanel(){const t=edacFrontendHighlighterApp?.widgetPosition||"right",e=edacFrontendHighlighterApp&&edacFrontendHighlighterApp?.userCanEdit&&edacFrontendHighlighterApp?.loggedIn,n=e?`<button id="edac-highlight-clear-issues" class="edac-highlight-clear-issues">${(0,Tt.__)("Clear Issues","accessibility-checker")}</button>`:"",i=`\n                        <div id="edac-highlight-panel" class="edac-highlight-panel edac-highlight-panel--${t}">\n                                <button id="edac-highlight-panel-toggle" class="edac-highlight-panel-toggle" aria-haspopup="dialog" aria-label="Accessibility Checker Tools"></button>\n                                <div id="edac-highlight-panel-description" class="edac-highlight-panel-description" role="dialog" aria-labelledby="edac-highlight-panel-description-title" tabindex="0">\n                                <button class="edac-highlight-panel-description-close edac-highlight-panel-controls-close" aria-label="Close">×</button>\n                                        <div id="edac-highlight-panel-description-title" class="edac-highlight-panel-description-title"></div>\n                                        <div class="edac-highlight-panel-description-content"></div>\n                                        <div id="edac-highlight-panel-description-code" class="edac-highlight-panel-description-code"><code></code></div>\n                                </div>\n                                <div id="edac-highlight-panel-controls" class="edac-highlight-panel-controls" tabindex="0">\n                                <button id="edac-highlight-panel-controls-close" class="edac-highlight-panel-controls-close" aria-label="Close">×</button>\n                                <div class="edac-highlight-panel-controls-title">Accessibility Checker</div>\n                                <div class="edac-highlight-panel-controls-summary">Loading...</div>\n                                <div class="edac-highlight-panel-controls-buttons ${e?"":" single_button"}">\n                                        <div>\n                                                <button id="edac-highlight-previous" disabled="true"><span aria-hidden="true">« </span>Previous</button>\n                                                <button id="edac-highlight-next" disabled="true">Next<span aria-hidden="true"> »</span></button><br />\n                                        </div>\n                                        <div>\n                                                ${e?`<button id="edac-highlight-rescan" class="edac-highlight-rescan">${(0,Tt.__)("Rescan This Page","accessibility-checker")}</button>`:""}\n                                                ${n}\n                                                <button id="edac-highlight-disable-styles" class="edac-highlight-disable-styles" aria-live="polite" aria-label="${(0,Tt.__)("Disable Page Styles","accessibility-checker")}">${(0,Tt.__)("Disable Styles","accessibility-checker")}</button>\n                                        </div>\n                                </div>\n                        </div>\n                        </div>\n                `;return document.body.insertAdjacentHTML("afterbegin",i),document.getElementById("edac-highlight-panel")}highlightFocusNext=()=>{null===this.currentButtonIndex?this.currentButtonIndex=0:this.currentButtonIndex=(this.currentButtonIndex+1)%this.issues.length;const t=this.issues[this.currentButtonIndex].id;this.showIssue(t)};highlightFocusPrevious=()=>{null===this.currentButtonIndex?this.currentButtonIndex=this.issues.length-1:this.currentButtonIndex=(this.currentButtonIndex-1+this.issues.length)%this.issues.length;const t=this.issues[this.currentButtonIndex].id;this.showIssue(t)};focusTrapControls=()=>{this.panelDescriptionFocusTrap.deactivate(),this.panelControlsFocusTrap.activate(),setTimeout((()=>{this.panelControls.focus()}),100)};focusTrapDescription=()=>{this.panelControlsFocusTrap.deactivate(),this.panelDescriptionFocusTrap.activate(),setTimeout((()=>{this.panelDescription.focus()}),100)};showIssue=t=>{if(this.removeSelectedClasses(),void 0===t)return;const e=this.issues.find((e=>e.id===t));this.currentButtonIndex=this.issues.findIndex((e=>e.id===t));const n=e.tooltip,i=e.element;n&&i?(n.classList.add("edac-highlight-btn-selected"),i.classList.add("edac-highlight-element-selected"),i.offsetWidth<20&&i.classList.add("edac-highlight-element-selected-min-width"),i.offsetHeight<5&&i.classList.add("edac-highlight-element-selected-min-height"),i.scrollIntoView({block:"center"}),ut(n)?this.checkVisibility(n)&&this.checkVisibility(i)?this.currentIssueStatus=null:this.currentIssueStatus="The element is not visible. Try disabling styles.":this.currentIssueStatus="The element is not focusable. Try disabling styles."):this.currentIssueStatus="The element was not found on the page.",this.descriptionOpen(t)};checkVisibility=t=>"function"!=typeof t.checkVisibility?!!(t.offsetWidth||t.offsetHeight||t.getClientRects().length):t.checkVisibility({checkOpacity:!0,checkVisibilityCSS:!0});panelOpen(t){this.highlightPanel.classList.add("edac-highlight-panel-visible"),this.panelControls.style.display="block",this.panelToggle.style.display="none",this.nextButton.disabled=!0,this.previousButton.disabled=!0,this.highlightAjax().then((e=>{this.issues=e.issues,this.fixes=e.fixes,e.issues.forEach(function(t,e){const n=this.findElement(t,e);null!==n&&(this.issues[e].element=n)}.bind(this)),this.showIssueCount(),void 0!==t&&(this.showIssue(t),this.focusTrapDescription())})).catch((t=>{const e=document.querySelector(".edac-highlight-panel-controls-summary");e&&(e.textContent=(0,Tt.__)("An error occurred when loading the issues.","accessibility-checker"))}))}panelClose(){this.highlightPanel.classList.remove("edac-highlight-panel-visible"),this.panelControls.style.display="none",this.panelDescription.style.display="none",this.panelToggle.style.display="block",this.removeSelectedClasses(),this.removeHighlightButtons(),this.closePanel.removeEventListener("click",this.panelControlsFocusTrap.deactivate),this.panelToggle.focus()}removeSelectedClasses=()=>{document.querySelectorAll(".edac-highlight-btn-selected").forEach((t=>{t.classList.remove("edac-highlight-btn-selected")}));document.querySelectorAll(".edac-highlight-element-selected").forEach((t=>{t.classList.remove("edac-highlight-element-selected","edac-highlight-element-selected-min-width","edac-highlight-element-selected-min-height"),0===t.classList.length&&t.removeAttribute("class")})),this.removeLandmarkLabels()};descriptionOpen(t){const e=t,n=this.issues.find((t=>t.id===e));if(n){const t=document.querySelector(".edac-highlight-panel-description-title"),e=document.querySelector(".edac-highlight-panel-description-content"),i=document.querySelector(".edac-highlight-panel-description-code code");let o="";o+=` <div class="edac-highlight-panel-description-index">${this.currentButtonIndex+1} of ${this.issues.length}</div>`,this.currentIssueStatus&&(o+=` <div class="edac-highlight-panel-description-status">${this.currentIssueStatus}</div>`),n.summary&&(o+=`<p class="edac-highlight-panel-description-summary">${n.summary}</p>`),n.how_to_fix&&(o+=`<div class="edac-highlight-panel-description-how-to-fix">\n\t\t\t\t\t<div class="edac-highlight-panel-description-how-to-fix-title">How to fix it:</div>\n\t\t\t\t\t<p class="edac-highlight-panel-description-how-to-fix-content">${n.how_to_fix}</p>\n\t\t\t\t</div>`),this.fixes[n.slug]&&window.edacFrontendHighlighterApp?.userCanFix?(o+=`\n\t\t\t\t\t<div style="display:none;" class="always-hide">\n\t\t\t\t\t\t<div class="edac-fix-settings">\n\t\t\t\t\t\t\t<div class="edac-fix-settings--fields">\n\t\t\t\t\t\t\t\t${this.fixes[n.slug].fields}\n\t\t\t\t\t\t\t\t<div class="edac-fix-settings--action-row">\n\t\t\t\t\t\t\t\t\t<button role="button" class="button button-primary edac-fix-settings--button--save">\n\t\t\t\t\t\t\t\t\t\t${(0,Tt.__)("Save","accessibility-checker")}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<span class="edac-fix-settings--notice-slot" aria-live="polite" role="alert"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,o+=` <br />\n \t\t\t\t\t<button role="button"\n \t\t\t\t\t\tclass="edac-fix-settings--button--open edac-highlight-panel-description--button"\n \t\t\t\t\t\taria-haspopup="true"\n \t\t\t\t\t\taria-controls="edac-highlight-panel-description-fix"\n\t\t\t\t\t\taria-label="Fix issue: ${this.fixes[n.slug][Object.keys(this.fixes[n.slug])[0]].group_name}"> \t\t\t\t\t\tFix Issue</button>`):o+=" <br />",o+=`<a class="edac-highlight-panel-description-reference" href="${n.link}">Full Documentation</a>`,o+=`<button class="edac-highlight-panel-description-code-button" aria-expanded="false" aria-controls="edac-highlight-panel-description-code">${(0,Tt.__)("Show Code","accessibility-checker")}</button>`,t.innerHTML=n.rule_title+' <span class="edac-highlight-panel-description-type edac-highlight-panel-description-type-'+n.rule_type+'" aria-label="'+(0,Tt.__)("Issue type:","accessibility-checker")+" "+n.rule_type+'"> '+n.rule_type+"</span>",e.innerHTML=o;const s=n.object,r=(new DOMParser).parseFromString(s,"text/html").body.firstElementChild;if(r)i.innerText=r.outerHTML;else{const t=document.createTextNode(n.object);i.innerText=t.nodeValue}this.fixes[n.slug]&&window.edacFrontendHighlighterApp?.userCanFix&&(this.fixSettingsButton=document.querySelector(".edac-fix-settings--button--open"),this.fixSettingsButton.addEventListener("click",(t=>{this.showFixSettings(t)})),this.fixSettingsButton.display="block",this.fixSettingsSaveButton=document.querySelector(".edac-fix-settings--button--save"),this.fixSettingsSaveButton.addEventListener("click",(t=>{Ct(t.target.closest(".edac-fix-settings"))}))),this.codeContainer=document.querySelector(".edac-highlight-panel-description-code"),this.codeButton=document.querySelector(".edac-highlight-panel-description-code-button"),this.codeButton.addEventListener("click",(()=>this.codeToggle())),this.codeContainer.style.display="none",this.panelDescription.style.display="block"}}descriptionClose(){this.panelDescription.style.display="none",this.focusTrapControls()}disableStyles(){if(!document.querySelector("#edac-app-css")){const t=document.createElement("link");t.rel="stylesheet",t.id="edac-app-css",t.type="text/css",t.href=edacFrontendHighlighterApp.appCssUrl,t.media="all",document.head.appendChild(t)}this.originalCss=Array.from(document.head.querySelectorAll('style[type="text/css"], style, link[rel="stylesheet"]'));document.querySelectorAll('*[style]:not([class^="edac"])').forEach((function(t){t.removeAttribute("style")})),this.originalCss=this.originalCss.filter((function(t){return"edac-app-css"!==t.id&&"dashicons-css"!==t.id})),document.head.dataset.css=this.originalCss,this.originalCss.forEach((function(t){t.remove()})),document.querySelector("body").classList.add("edac-app-disable-styles"),this.stylesDisabled=!0,this.disableStylesButton.textContent=(0,Tt.__)("Enable Styles","accessibility-checker")}enableStyles(){this.originalCss.forEach((function(t){if("STYLE"===t.tagName)document.head.appendChild(t.cloneNode(!0));else{const e=document.createElement("link");e.rel="stylesheet",e.href=t.href,document.head.appendChild(e)}})),document.querySelector("body").classList.remove("edac-app-disable-styles"),this.stylesDisabled=!1,this.disableStylesButton.textContent=(0,Tt.__)("Disable Styles","accessibility-checker")}get_url_parameter(t){const e=window.location.search.substring(1).split("&");let n,i;for(i=0;i<e.length;i++)if(n=e[i].split("="),n[0]===t)return void 0===n[1]||decodeURIComponent(n[1]);return!1}codeToggle(){"none"===this.codeContainer.style.display||""===this.codeContainer.style.display?(this.codeContainer.style.display="block",this.codeButton.setAttribute("aria-expanded","true")):(this.codeContainer.style.display="none",this.codeButton.setAttribute("aria-expanded","false"))}showFixSettings(t){const e=t.target.closest(".edac-highlight-panel-description-content").querySelector(".edac-fix-settings");if(!e)return;const n=document.createElement("span");n.classList.add("edac-fix-settings--origin-placeholder"),e.parentNode.insertBefore(n,e),e.remove(),((t="",e="")=>{""===e&&((e=document.createElement("p")).innerText=(0,Tt.__)("There are no settings to display.","accessibility-checker"));const n=document.createElement("div");n.classList.add("edac-fix-settings--clone--wrapper"),n.appendChild(e);let i=n.querySelector("[data-fancy-name]")?.getAttribute("data-fancy-name")||"";""===i&&(i=n.querySelector("[data-group-name]")?.getAttribute("data-group-name")||"");const o=document.getElementById("edac-fixes-modal"),s=o.querySelector("#edac-fixes-modal-title"),r=o.querySelector(".edac-fixes-modal__body");s.innerText=i,r.innerHTML=t,r.appendChild(n),o.querySelectorAll("input, select, textarea").forEach((t=>{const e=()=>{document.dispatchEvent(new CustomEvent("edac-fix-settings-change"))};t.addEventListener("change",e),At.push({field:t,changeListener:e})})),o.querySelector(".edac-fix-settings--button--save").addEventListener("click",(()=>{Ct(r.querySelector(".edac-fix-settings--fields"))})),document.addEventListener("edac-fix-settings-change",(()=>{o.querySelector("[aria-live]").innerText=""}))})(`<p class="modal-opening-message">${(0,Tt.__)("These settings enable global fixes across your entire site. Pages may need to be resaved or a full site scan run to see fixes reflected in reports.","accessibility-checker")}</p>`,e),this.panelDescriptionFocusTrap.pause(),(t=>{const e=document.getElementById("edac-fixes-modal");e.classList.add("edac-fixes-modal--open"),e.setAttribute("aria-hidden","false"),e.setAttribute("aria-modal","true"),Array.from(document.body.children).forEach((t=>{"edac-fixes-modal"===t.id||t.classList.contains("edac-fixes-modal__overlay")||!0!==t.getAttribute("aria-hidden")&&(t.setAttribute("aria-hidden","true"),t.setAttribute("data-hidden-by-modal","true"))})),document.body.classList.add("edac-fixes-modal--open"),Lt=t;const n=e.querySelector(".edac-fixes-modal__body").querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');n&&setTimeout((()=>{n.focus()}),100),e.addEventListener("keydown",(t=>{if("Tab"===t.key){const n=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=n[0],o=n[n.length-1];t.shiftKey&&document.activeElement===i?(t.preventDefault(),o.focus()):t.shiftKey||document.activeElement!==o||(t.preventDefault(),i.focus())}}))})(t.target),document.addEventListener("edac-fixes-modal-closed",(()=>{this.panelDescriptionFocusTrap.unpause()}))}countIssues(t){let e=0;for(const n of this.issues)n.rule_type===t&&e++;return e}countIgnored(){let t=0;for(const e of this.issues)1===e.ignored&&t++;return t}showIssueCount(){const t=this.countIssues("error"),e=this.countIssues("warning"),n=this.countIgnored(),i=document.querySelector(".edac-highlight-panel-controls-summary");let o=(0,Tt.__)("No issues detected.","accessibility-checker");(t>0||e>0||n>0)&&(o="",this.nextButton.disabled=!1,this.previousButton.disabled=!1,t>=0&&(o+=t+" "+(0,Tt._n)("error","errors",t,"accessibility-checker")+", "),e>=0&&(o+=e+" "+(0,Tt._n)("warning","warnings",e,"accessibility-checker")+", "),n>=0?o+=(0,Tt.__)("and","accessibility-checker")+" "+n+" "+(0,Tt._n)("ignored issue","ignored issues",n,"accessibility-checker")+" "+(0,Tt.__)("detected.","accessibility-checker"):o=o.slice(0,-2)+" "+(0,Tt.__)("detected.","accessibility-checker")),i.textContent=o}highlightLandmark(t){try{const e=atob(t);let n=null;try{n=document.querySelector(e)}catch(t){}if(!n){const t=[e.replace(/:nth-child\(\d+\)/g,"").replace(/\s+>\s+/g," "),e.split(" > ").pop(),e.replace(/\.[^:\s>]+/g,"")];for(const e of t)if(e&&e.trim())try{if(n=document.querySelector(e.trim()),n)break}catch(t){}}if(n){this.removeLandmarkLabels(),n.classList.add("edac-highlight-element-selected"),n.classList.add("edac-landmark-highlight");const t=this.getLandmarkType(n),e=document.createElement("div");e.classList.add("edac-landmark-label"),e.textContent=`Landmark: ${t}`,e.setAttribute("aria-hidden","true"),e.style.cssText="\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbackground: #072446;\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tz-index: 99998;\n\t\t\t\t\tpointer-events: none;\n\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n\t\t\t\t\tline-height: 1;\n\t\t\t\t\tbox-shadow: 0 2px 4px rgba(0,0,0,0.2);\n\t\t\t\t";const i=n.getBoundingClientRect();e.style.left=i.left+window.scrollX-0+"px",e.style.top=i.top+window.scrollY-0+"px",document.body.appendChild(e),n.setAttribute("data-edac-landmark-label-id",Date.now()),e.setAttribute("data-edac-landmark-for",n.getAttribute("data-edac-landmark-label-id")),n.offsetWidth<20&&n.classList.add("edac-highlight-element-selected-min-width"),n.offsetHeight<5&&n.classList.add("edac-highlight-element-selected-min-height");const o=n.getBoundingClientRect().top+window.scrollY-75;window.scrollTo({top:o,behavior:"smooth"})}}catch(t){}}getLandmarkType(t){const e=t.getAttribute("role");if(e)switch(e.toLowerCase()){case"banner":return"Header";case"navigation":return"Navigation";case"main":return"Main";case"complementary":return"Complementary";case"contentinfo":return"Footer";case"search":return"Search";case"form":return"Form";case"region":return"Region";default:return e.charAt(0).toUpperCase()+e.slice(1)}switch(t.tagName.toLowerCase()){case"header":return"Header";case"nav":return"Navigation";case"main":return"Main";case"aside":return"Complementary";case"footer":return"Footer";case"section":return t.getAttribute("aria-label")||t.getAttribute("aria-labelledby")||t.querySelector("h1, h2, h3, h4, h5, h6")?"Region":"Section";case"form":return t.getAttribute("aria-label")||t.getAttribute("aria-labelledby")?"Form":"Form (unlabeled)";default:return"Landmark"}}removeLandmarkLabels(){document.querySelectorAll(".edac-landmark-label").forEach((t=>{t.remove()}));document.querySelectorAll(".edac-landmark-highlight").forEach((t=>{t.classList.remove("edac-landmark-highlight"),t.removeAttribute("data-edac-landmark-label-id")}))}kickoffScan(){const t={elementCount:document.body.getElementsByTagName("*").length,contentLength:document.body.innerText.length},e=this,n="edac-accessibility-checker-scanner-script";if(document.getElementById(n))e._runScanOrShowError(t);else{const i=document.createElement("script");i.src=window.edacFrontendHighlighterApp?.scannerBundleUrl||"/wp-content/plugins/accessibility-checker/build/pageScanner.bundle.js",i.id=n,i.onload=function(){setTimeout((()=>{e._runScanOrShowError(t)}),100)},i.onerror=function(){e.showWait(!1),e.showScanError("Failed to load scanner script.")},document.head.appendChild(i)}}_runScanOrShowError(t){window.runAccessibilityScan?this.runAccessibilityScanAndSave(t):(this.showWait(!1),this.showScanError((0,Tt.__)("Scanner function not found.","accessibility-checker")))}runAccessibilityScanAndSave(t){const e=this,n=document.querySelector(".edac-highlight-panel-controls-summary");n&&(n.textContent=(0,Tt.__)("Scanning...","accessibility-checker"),n.classList.remove("edac-error")),window.runAccessibilityScan().then((n=>{const i=window.edacFrontendHighlighterApp&&window.edacFrontendHighlighterApp.postID,o=window.edacFrontendHighlighterApp&&window.edacFrontendHighlighterApp.restNonce;return i&&o?n&&n.violations&&0!==n.violations.length?void e.saveScanResults(i,o,n.violations,t):(e.showWait(!1),void e.showScanError((0,Tt.__)("No violations found, skipping save.","accessibility-checker"))):(e.showWait(!1),void e.showScanError((0,Tt.__)("Missing postId or nonce.","accessibility-checker")))})).catch((()=>{e.showWait(!1),e.showScanError((0,Tt.__)("Accessibility scan error.","accessibility-checker"))}))}saveScanResults(t,e,n,i){const o=this;fetch("/wp-json/accessibility-checker/v1/post-scan-results/"+t,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":e},body:JSON.stringify({violations:n,isSkipped:!1,isFailure:!1,densityMetrics:i})}).then((t=>t.json())).then((t=>{o.showWait(!1),t&&t.success||o.showScanError((0,Tt.__)("Saving failed.","accessibility-checker"))})).catch((()=>{o.showWait(!1),o.showScanError((0,Tt.__)("Error saving scan results.","accessibility-checker"))}))}rescanPage(){this._isRescanning||(this._isRescanning=!0,this.removeHighlightButtons(),this.kickoffScan(),setTimeout((()=>{this._isRescanning=!1,this.panelOpen()}),5e3))}clearIssues(){if(!confirm((0,Tt.__)("This will clear all issues for this post. A save will be required to trigger a fresh scan of the post content. Do you want to continue?","accessibility-checker")))return;if(!this.clearIssuesButton)return;if(!edacFrontendHighlighterApp?.edacUrl||!edacFrontendHighlighterApp?.postID){const t=document.querySelector(".edac-highlight-panel-controls-summary");return void(t&&(t.textContent=(0,Tt.__)("Error: Missing required parameters.","accessibility-checker"),t.classList.add("edac-error")))}this.clearIssuesButton.disabled=!0,this.clearIssuesButton.textContent=(0,Tt.__)("Clearing...","accessibility-checker");const t=document.querySelector(".edac-highlight-panel-controls-summary");fetch(`${edacFrontendHighlighterApp.edacUrl}/wp-json/accessibility-checker/v1/clear-issues/${edacFrontendHighlighterApp.postID}`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":edacFrontendHighlighterApp.restNonce},body:JSON.stringify({id:edacFrontendHighlighterApp.postID,flush:!0})}).then((e=>{e.ok?(this.removeHighlightButtons(),this.issues=[],this.showIssueCount(),t&&(t.textContent=(0,Tt.__)("Issues cleared successfully.","accessibility-checker"),t.classList.remove("edac-error"))):t&&(t.textContent=(0,Tt.__)("Failed to clear issues.","accessibility-checker"),t.classList.add("edac-error"))})).catch((()=>{t&&(t.textContent=(0,Tt.__)("An error occurred while clearing issues.","accessibility-checker"),t.classList.add("edac-error"))})).finally((()=>{this.clearIssuesButton.disabled=!1,this.clearIssuesButton.textContent=(0,Tt.__)("Clear Issues","accessibility-checker")}))}showScanError(t){const e=document.querySelector(".edac-highlight-panel-controls-summary");e&&(e.textContent=t,e.classList.add("edac-error"))}}let Wt=!1;const $t=()=>{Wt||(new jt,window.edacFrontendHighlighterApp?.userCanFix&&Ft(),Wt=!0)};["DOMContentLoaded","load"].forEach((t=>{window.addEventListener(t,$t)}))})()})();