/*! For license information please see frontendHighlighterApp.bundle.js.LICENSE.txt */
(()=>{"use strict";(()=>{const e=Math.min,t=Math.max,n=Math.round,i=Math.floor,s=e=>({x:e,y:e});function o(e){return e.split("-")[0]}function r(e){return e.split("-")[1]}function a(e){return"y"===e?"height":"width"}function c(e){return["top","bottom"].includes(o(e))?"y":"x"}function l(e){return"x"===c(e)?"y":"x"}function d(e){return{...e,top:e.y,left:e.x,right:e.x+e.width,bottom:e.y+e.height}}function u(e,t,n){let{reference:i,floating:s}=e;const d=c(t),u=l(t),h=a(u),p=o(t),f="y"===d,g=i.x+i.width/2-s.width/2,m=i.y+i.height/2-s.height/2,b=i[h]/2-s[h]/2;let y;switch(p){case"top":y={x:g,y:i.y-s.height};break;case"bottom":y={x:g,y:i.y+i.height};break;case"right":y={x:i.x+i.width,y:m};break;case"left":y={x:i.x-s.width,y:m};break;default:y={x:i.x,y:i.y}}switch(r(t)){case"start":y[u]-=b*(n&&f?-1:1);break;case"end":y[u]+=b*(n&&f?-1:1)}return y}function h(e){return g(e)?(e.nodeName||"").toLowerCase():"#document"}function p(e){var t;return(null==e||null==(t=e.ownerDocument)?void 0:t.defaultView)||window}function f(e){var t;return null==(t=(g(e)?e.ownerDocument:e.document)||window.document)?void 0:t.documentElement}function g(e){return e instanceof Node||e instanceof p(e).Node}function m(e){return e instanceof Element||e instanceof p(e).Element}function b(e){return e instanceof HTMLElement||e instanceof p(e).HTMLElement}function y(e){return"undefined"!=typeof ShadowRoot&&(e instanceof ShadowRoot||e instanceof p(e).ShadowRoot)}function v(e){const{overflow:t,overflowX:n,overflowY:i,display:s}=E(e);return/auto|scroll|overlay|hidden|clip/.test(t+i+n)&&!["inline","contents"].includes(s)}function w(e){return["table","td","th"].includes(h(e))}function x(e){const t=S(),n=E(e);return"none"!==n.transform||"none"!==n.perspective||!!n.containerType&&"normal"!==n.containerType||!t&&!!n.backdropFilter&&"none"!==n.backdropFilter||!t&&!!n.filter&&"none"!==n.filter||["transform","perspective","filter"].some((e=>(n.willChange||"").includes(e)))||["paint","layout","strict","content"].some((e=>(n.contain||"").includes(e)))}function S(){return!("undefined"==typeof CSS||!CSS.supports)&&CSS.supports("-webkit-backdrop-filter","none")}function k(e){return["html","body","#document"].includes(h(e))}function E(e){return p(e).getComputedStyle(e)}function _(e){return m(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.pageXOffset,scrollTop:e.pageYOffset}}function T(e){if("html"===h(e))return e;const t=e.assignedSlot||e.parentNode||y(e)&&e.host||f(e);return y(t)?t.host:t}function L(e){const t=T(e);return k(t)?e.ownerDocument?e.ownerDocument.body:e.body:b(t)&&v(t)?t:L(t)}function C(e,t,n){var i;void 0===t&&(t=[]),void 0===n&&(n=!0);const s=L(e),o=s===(null==(i=e.ownerDocument)?void 0:i.body),r=p(s);return o?t.concat(r,r.visualViewport||[],v(s)?s:[],r.frameElement&&n?C(r.frameElement):[]):t.concat(s,C(s,[],n))}function A(e){const t=E(e);let i=parseFloat(t.width)||0,s=parseFloat(t.height)||0;const o=b(e),r=o?e.offsetWidth:i,a=o?e.offsetHeight:s,c=n(i)!==r||n(s)!==a;return c&&(i=r,s=a),{width:i,height:s,$:c}}function I(e){return m(e)?e:e.contextElement}function F(e){const t=I(e);if(!b(t))return s(1);const i=t.getBoundingClientRect(),{width:o,height:r,$:a}=A(t);let c=(a?n(i.width):i.width)/o,l=(a?n(i.height):i.height)/r;return c&&Number.isFinite(c)||(c=1),l&&Number.isFinite(l)||(l=1),{x:c,y:l}}const N=s(0);function D(e){const t=p(e);return S()&&t.visualViewport?{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}:N}function O(e,t,n,i){void 0===t&&(t=!1),void 0===n&&(n=!1);const o=e.getBoundingClientRect(),r=I(e);let a=s(1);t&&(i?m(i)&&(a=F(i)):a=F(e));const c=function(e,t,n){return void 0===t&&(t=!1),!(!n||t&&n!==p(e))&&t}(r,n,i)?D(r):s(0);let l=(o.left+c.x)/a.x,u=(o.top+c.y)/a.y,h=o.width/a.x,f=o.height/a.y;if(r){const e=p(r),t=i&&m(i)?p(i):i;let n=e.frameElement;for(;n&&i&&t!==e;){const e=F(n),t=n.getBoundingClientRect(),i=E(n),s=t.left+(n.clientLeft+parseFloat(i.paddingLeft))*e.x,o=t.top+(n.clientTop+parseFloat(i.paddingTop))*e.y;l*=e.x,u*=e.y,h*=e.x,f*=e.y,l+=s,u+=o,n=p(n).frameElement}}return d({width:h,height:f,x:l,y:u})}function B(e){return O(f(e)).left+_(e).scrollLeft}function R(e,n,i){let o;if("viewport"===n)o=function(e,t){const n=p(e),i=f(e),s=n.visualViewport;let o=i.clientWidth,r=i.clientHeight,a=0,c=0;if(s){o=s.width,r=s.height;const e=S();(!e||e&&"fixed"===t)&&(a=s.offsetLeft,c=s.offsetTop)}return{width:o,height:r,x:a,y:c}}(e,i);else if("document"===n)o=function(e){const n=f(e),i=_(e),s=e.ownerDocument.body,o=t(n.scrollWidth,n.clientWidth,s.scrollWidth,s.clientWidth),r=t(n.scrollHeight,n.clientHeight,s.scrollHeight,s.clientHeight);let a=-i.scrollLeft+B(e);const c=-i.scrollTop;return"rtl"===E(s).direction&&(a+=t(n.clientWidth,s.clientWidth)-o),{width:o,height:r,x:a,y:c}}(f(e));else if(m(n))o=function(e,t){const n=O(e,!0,"fixed"===t),i=n.top+e.clientTop,o=n.left+e.clientLeft,r=b(e)?F(e):s(1);return{width:e.clientWidth*r.x,height:e.clientHeight*r.y,x:o*r.x,y:i*r.y}}(n,i);else{const t=D(e);o={...n,x:n.x-t.x,y:n.y-t.y}}return d(o)}function P(e,t){const n=T(e);return!(n===t||!m(n)||k(n))&&("fixed"===E(n).position||P(n,t))}function q(e,t,n){const i=b(t),o=f(t),r="fixed"===n,a=O(e,!0,r,t);let c={scrollLeft:0,scrollTop:0};const l=s(0);if(i||!i&&!r)if(("body"!==h(t)||v(o))&&(c=_(t)),i){const e=O(t,!0,r,t);l.x=e.x+t.clientLeft,l.y=e.y+t.clientTop}else o&&(l.x=B(o));return{x:a.left+c.scrollLeft-l.x,y:a.top+c.scrollTop-l.y,width:a.width,height:a.height}}function H(e,t){return b(e)&&"fixed"!==E(e).position?t?t(e):e.offsetParent:null}function $(e,t){const n=p(e);if(!b(e))return n;let i=H(e,t);for(;i&&w(i)&&"static"===E(i).position;)i=H(i,t);return i&&("html"===h(i)||"body"===h(i)&&"static"===E(i).position&&!x(i))?n:i||function(e){let t=T(e);for(;b(t)&&!k(t);){if(x(t))return t;t=T(t)}return null}(e)||n}const M={convertOffsetParentRelativeRectToViewportRelativeRect:function(e){let{rect:t,offsetParent:n,strategy:i}=e;const o=b(n),r=f(n);if(n===r)return t;let a={scrollLeft:0,scrollTop:0},c=s(1);const l=s(0);if((o||!o&&"fixed"!==i)&&(("body"!==h(n)||v(r))&&(a=_(n)),b(n))){const e=O(n);c=F(n),l.x=e.x+n.clientLeft,l.y=e.y+n.clientTop}return{width:t.width*c.x,height:t.height*c.y,x:t.x*c.x-a.scrollLeft*c.x+l.x,y:t.y*c.y-a.scrollTop*c.y+l.y}},getDocumentElement:f,getClippingRect:function(n){let{element:i,boundary:s,rootBoundary:o,strategy:r}=n;const a=[..."clippingAncestors"===s?function(e,t){const n=t.get(e);if(n)return n;let i=C(e,[],!1).filter((e=>m(e)&&"body"!==h(e))),s=null;const o="fixed"===E(e).position;let r=o?T(e):e;for(;m(r)&&!k(r);){const t=E(r),n=x(r);n||"fixed"!==t.position||(s=null),(o?!n&&!s:!n&&"static"===t.position&&s&&["absolute","fixed"].includes(s.position)||v(r)&&!n&&P(e,r))?i=i.filter((e=>e!==r)):s=t,r=T(r)}return t.set(e,i),i}(i,this._c):[].concat(s),o],c=a[0],l=a.reduce(((n,s)=>{const o=R(i,s,r);return n.top=t(o.top,n.top),n.right=e(o.right,n.right),n.bottom=e(o.bottom,n.bottom),n.left=t(o.left,n.left),n}),R(i,c,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}},getOffsetParent:$,getElementRects:async function(e){let{reference:t,floating:n,strategy:i}=e;const s=this.getOffsetParent||$,o=this.getDimensions;return{reference:q(t,await s(n),i),floating:{x:0,y:0,...await o(n)}}},getClientRects:function(e){return Array.from(e.getClientRects())},getDimensions:function(e){return A(e)},getScale:F,isElement:m,isRTL:function(e){return"rtl"===E(e).direction}};function j(n,s,o,r){void 0===r&&(r={});const{ancestorScroll:a=!0,ancestorResize:c=!0,elementResize:l="function"==typeof ResizeObserver,layoutShift:d="function"==typeof IntersectionObserver,animationFrame:u=!1}=r,h=I(n),p=a||c?[...h?C(h):[],...C(s)]:[];p.forEach((e=>{a&&e.addEventListener("scroll",o,{passive:!0}),c&&e.addEventListener("resize",o)}));const g=h&&d?function(n,s){let o,r=null;const a=f(n);function c(){clearTimeout(o),r&&r.disconnect(),r=null}return function l(d,u){void 0===d&&(d=!1),void 0===u&&(u=1),c();const{left:h,top:p,width:f,height:g}=n.getBoundingClientRect();if(d||s(),!f||!g)return;const m={rootMargin:-i(p)+"px "+-i(a.clientWidth-(h+f))+"px "+-i(a.clientHeight-(p+g))+"px "+-i(h)+"px",threshold:t(0,e(1,u))||1};let b=!0;function y(e){const t=e[0].intersectionRatio;if(t!==u){if(!b)return l();t?l(!1,t):o=setTimeout((()=>{l(!1,1e-7)}),100)}b=!1}try{r=new IntersectionObserver(y,{...m,root:a.ownerDocument})}catch(e){r=new IntersectionObserver(y,m)}r.observe(n)}(!0),c}(h,o):null;let m,b=-1,y=null;l&&(y=new ResizeObserver((e=>{let[t]=e;t&&t.target===h&&y&&(y.unobserve(s),cancelAnimationFrame(b),b=requestAnimationFrame((()=>{y&&y.observe(s)}))),o()})),h&&!u&&y.observe(h),y.observe(s));let v=u?O(n):null;return u&&function e(){const t=O(n);!v||t.x===v.x&&t.y===v.y&&t.width===v.width&&t.height===v.height||o();v=t,m=requestAnimationFrame(e)}(),o(),()=>{p.forEach((e=>{a&&e.removeEventListener("scroll",o),c&&e.removeEventListener("resize",o)})),g&&g(),y&&y.disconnect(),y=null,u&&cancelAnimationFrame(m)}}const W=(e,t,n)=>{const i=new Map,s={platform:M,...n},o={...s.platform,_c:i};return(async(e,t,n)=>{const{placement:i="bottom",strategy:s="absolute",middleware:o=[],platform:r}=n,a=o.filter(Boolean),c=await(null==r.isRTL?void 0:r.isRTL(t));let l=await r.getElementRects({reference:e,floating:t,strategy:s}),{x:d,y:h}=u(l,i,c),p=i,f={},g=0;for(let n=0;n<a.length;n++){const{name:o,fn:m}=a[n],{x:b,y,data:v,reset:w}=await m({x:d,y:h,initialPlacement:i,placement:p,strategy:s,middlewareData:f,rects:l,platform:r,elements:{reference:e,floating:t}});d=null!=b?b:d,h=null!=y?y:h,f={...f,[o]:{...f[o],...v}},w&&g<=50&&(g++,"object"==typeof w&&(w.placement&&(p=w.placement),w.rects&&(l=!0===w.rects?await r.getElementRects({reference:e,floating:t,strategy:s}):w.rects),({x:d,y:h}=u(l,p,c))),n=-1)}return{x:d,y:h,placement:p,strategy:s,middlewareData:f}})(e,t,{...s,platform:o})};var G=["input:not([inert])","select:not([inert])","textarea:not([inert])","a[href]:not([inert])","button:not([inert])","[tabindex]:not(slot):not([inert])","audio[controls]:not([inert])","video[controls]:not([inert])",'[contenteditable]:not([contenteditable="false"]):not([inert])',"details>summary:first-of-type:not([inert])","details:not([inert])"],U=G.join(","),V="undefined"==typeof Element,K=V?function(){}:Element.prototype.matches||Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector,z=!V&&Element.prototype.getRootNode?function(e){var t;return null==e||null===(t=e.getRootNode)||void 0===t?void 0:t.call(e)}:function(e){return null==e?void 0:e.ownerDocument},Y=function e(t,n){var i;void 0===n&&(n=!0);var s=null==t||null===(i=t.getAttribute)||void 0===i?void 0:i.call(t,"inert");return""===s||"true"===s||n&&t&&e(t.parentNode)},X=function(e,t,n){if(Y(e))return[];var i=Array.prototype.slice.apply(e.querySelectorAll(U));return t&&K.call(e,U)&&i.unshift(e),i=i.filter(n)},J=function e(t,n,i){for(var s=[],o=Array.from(t);o.length;){var r=o.shift();if(!Y(r,!1))if("SLOT"===r.tagName){var a=r.assignedElements(),c=e(a.length?a:r.children,!0,i);i.flatten?s.push.apply(s,c):s.push({scopeParent:r,candidates:c})}else{K.call(r,U)&&i.filter(r)&&(n||!t.includes(r))&&s.push(r);var l=r.shadowRoot||"function"==typeof i.getShadowRoot&&i.getShadowRoot(r),d=!Y(l,!1)&&(!i.shadowRootFilter||i.shadowRootFilter(r));if(l&&d){var u=e(!0===l?r.children:l.children,!0,i);i.flatten?s.push.apply(s,u):s.push({scopeParent:r,candidates:u})}else o.unshift.apply(o,r.children)}}return s},Q=function(e){return!isNaN(parseInt(e.getAttribute("tabindex"),10))},Z=function(e){if(!e)throw new Error("No node provided");return e.tabIndex<0&&(/^(AUDIO|VIDEO|DETAILS)$/.test(e.tagName)||function(e){var t,n=null==e||null===(t=e.getAttribute)||void 0===t?void 0:t.call(e,"contenteditable");return""===n||"true"===n}(e))&&!Q(e)?0:e.tabIndex},ee=function(e,t){return e.tabIndex===t.tabIndex?e.documentOrder-t.documentOrder:e.tabIndex-t.tabIndex},te=function(e){return"INPUT"===e.tagName},ne=function(e){return function(e){return te(e)&&"radio"===e.type}(e)&&!function(e){if(!e.name)return!0;var t,n=e.form||z(e),i=function(e){return n.querySelectorAll('input[type="radio"][name="'+e+'"]')};if("undefined"!=typeof window&&void 0!==window.CSS&&"function"==typeof window.CSS.escape)t=i(window.CSS.escape(e.name));else try{t=i(e.name)}catch(e){return console.error("Looks like you have a radio button with a name attribute containing invalid CSS selector characters and need the CSS.escape polyfill: %s",e.message),!1}var s=function(e,t){for(var n=0;n<e.length;n++)if(e[n].checked&&e[n].form===t)return e[n]}(t,e.form);return!s||s===e}(e)},ie=function(e){var t=e.getBoundingClientRect(),n=t.width,i=t.height;return 0===n&&0===i},se=function(e,t){var n=t.displayCheck,i=t.getShadowRoot;if("hidden"===getComputedStyle(e).visibility)return!0;var s=K.call(e,"details>summary:first-of-type")?e.parentElement:e;if(K.call(s,"details:not([open]) *"))return!0;if(n&&"full"!==n&&"legacy-full"!==n){if("non-zero-area"===n)return ie(e)}else{if("function"==typeof i){for(var o=e;e;){var r=e.parentElement,a=z(e);if(r&&!r.shadowRoot&&!0===i(r))return ie(e);e=e.assignedSlot?e.assignedSlot:r||a===e.ownerDocument?r:a.host}e=o}if(function(e){var t,n,i,s,o=e&&z(e),r=null===(t=o)||void 0===t?void 0:t.host,a=!1;if(o&&o!==e)for(a=!!(null!==(n=r)&&void 0!==n&&null!==(i=n.ownerDocument)&&void 0!==i&&i.contains(r)||null!=e&&null!==(s=e.ownerDocument)&&void 0!==s&&s.contains(e));!a&&r;){var c,l,d;a=!(null===(l=r=null===(c=o=z(r))||void 0===c?void 0:c.host)||void 0===l||null===(d=l.ownerDocument)||void 0===d||!d.contains(r))}return a}(e))return!e.getClientRects().length;if("legacy-full"!==n)return!0}return!1},oe=function(e,t){return!(t.disabled||Y(t)||function(e){return te(e)&&"hidden"===e.type}(t)||se(t,e)||function(e){return"DETAILS"===e.tagName&&Array.prototype.slice.apply(e.children).some((function(e){return"SUMMARY"===e.tagName}))}(t)||function(e){if(/^(INPUT|BUTTON|SELECT|TEXTAREA)$/.test(e.tagName))for(var t=e.parentElement;t;){if("FIELDSET"===t.tagName&&t.disabled){for(var n=0;n<t.children.length;n++){var i=t.children.item(n);if("LEGEND"===i.tagName)return!!K.call(t,"fieldset[disabled] *")||!i.contains(e)}return!0}t=t.parentElement}return!1}(t))},re=function(e,t){return!(ne(t)||Z(t)<0||!oe(e,t))},ae=function(e){var t=parseInt(e.getAttribute("tabindex"),10);return!!(isNaN(t)||t>=0)},ce=function e(t){var n=[],i=[];return t.forEach((function(t,s){var o=!!t.scopeParent,r=o?t.scopeParent:t,a=function(e,t){var n=Z(e);return n<0&&t&&!Q(e)?0:n}(r,o),c=o?e(t.candidates):r;0===a?o?n.push.apply(n,c):n.push(r):i.push({documentOrder:s,tabIndex:a,item:t,isScope:o,content:c})})),i.sort(ee).reduce((function(e,t){return t.isScope?e.push.apply(e,t.content):e.push(t.content),e}),[]).concat(n)},le=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==K.call(e,U)&&re(t,e)},de=G.concat("iframe").join(","),ue=function(e,t){if(t=t||{},!e)throw new Error("No node provided");return!1!==K.call(e,de)&&oe(t,e)};function he(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function pe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?he(Object(n),!0).forEach((function(t){fe(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):he(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function fe(e,t,n){return(t=function(e){var t=function(e,t){if("object"!=typeof e||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var i=n.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ge=function(e,t){if(e.length>0){var n=e[e.length-1];n!==t&&n.pause()}var i=e.indexOf(t);-1===i||e.splice(i,1),e.push(t)},me=function(e,t){var n=e.indexOf(t);-1!==n&&e.splice(n,1),e.length>0&&e[e.length-1].unpause()},be=function(e){return"Tab"===(null==e?void 0:e.key)||9===(null==e?void 0:e.keyCode)},ye=function(e){return be(e)&&!e.shiftKey},ve=function(e){return be(e)&&e.shiftKey},we=function(e){return setTimeout(e,0)},xe=function(e,t){var n=-1;return e.every((function(e,i){return!t(e)||(n=i,!1)})),n},Se=function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];return"function"==typeof e?e.apply(void 0,n):e},ke=function(e){return e.target.shadowRoot&&"function"==typeof e.composedPath?e.composedPath()[0]:e.target},Ee=[],_e=function(e,t){var n,i=(null==t?void 0:t.document)||document,s=(null==t?void 0:t.trapStack)||Ee,o=pe({returnFocusOnDeactivate:!0,escapeDeactivates:!0,delayInitialFocus:!0,isKeyForward:ye,isKeyBackward:ve},t),r={containers:[],containerGroups:[],tabbableGroups:[],nodeFocusedBeforeActivation:null,mostRecentlyFocusedNode:null,active:!1,paused:!1,delayInitialFocusTimer:void 0,recentNavEvent:void 0},a=function(e,t,n){return e&&void 0!==e[t]?e[t]:o[n||t]},c=function(e,t){var n="function"==typeof(null==t?void 0:t.composedPath)?t.composedPath():void 0;return r.containerGroups.findIndex((function(t){var i=t.container,s=t.tabbableNodes;return i.contains(e)||(null==n?void 0:n.includes(i))||s.find((function(t){return t===e}))}))},l=function(e){var t=o[e];if("function"==typeof t){for(var n=arguments.length,s=new Array(n>1?n-1:0),r=1;r<n;r++)s[r-1]=arguments[r];t=t.apply(void 0,s)}if(!0===t&&(t=void 0),!t){if(void 0===t||!1===t)return t;throw new Error("`".concat(e,"` was specified but was not a node, or did not return a node"))}var a=t;if("string"==typeof t&&!(a=i.querySelector(t)))throw new Error("`".concat(e,"` as selector refers to no known node"));return a},d=function(){var e=l("initialFocus");if(!1===e)return!1;if(void 0===e||!ue(e,o.tabbableOptions))if(c(i.activeElement)>=0)e=i.activeElement;else{var t=r.tabbableGroups[0];e=t&&t.firstTabbableNode||l("fallbackFocus")}if(!e)throw new Error("Your focus-trap needs to have at least one focusable element");return e},u=function(){if(r.containerGroups=r.containers.map((function(e){var t=function(e,t){var n;return n=(t=t||{}).getShadowRoot?J([e],t.includeContainer,{filter:re.bind(null,t),flatten:!1,getShadowRoot:t.getShadowRoot,shadowRootFilter:ae}):X(e,t.includeContainer,re.bind(null,t)),ce(n)}(e,o.tabbableOptions),n=function(e,t){return(t=t||{}).getShadowRoot?J([e],t.includeContainer,{filter:oe.bind(null,t),flatten:!0,getShadowRoot:t.getShadowRoot}):X(e,t.includeContainer,oe.bind(null,t))}(e,o.tabbableOptions),i=t.length>0?t[0]:void 0,s=t.length>0?t[t.length-1]:void 0,r=n.find((function(e){return le(e)})),a=n.slice().reverse().find((function(e){return le(e)})),c=!!t.find((function(e){return Z(e)>0}));return{container:e,tabbableNodes:t,focusableNodes:n,posTabIndexesFound:c,firstTabbableNode:i,lastTabbableNode:s,firstDomTabbableNode:r,lastDomTabbableNode:a,nextTabbableNode:function(e){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],s=t.indexOf(e);return s<0?i?n.slice(n.indexOf(e)+1).find((function(e){return le(e)})):n.slice(0,n.indexOf(e)).reverse().find((function(e){return le(e)})):t[s+(i?1:-1)]}}})),r.tabbableGroups=r.containerGroups.filter((function(e){return e.tabbableNodes.length>0})),r.tabbableGroups.length<=0&&!l("fallbackFocus"))throw new Error("Your focus-trap must have at least one container with at least one tabbable node in it at all times");if(r.containerGroups.find((function(e){return e.posTabIndexesFound}))&&r.containerGroups.length>1)throw new Error("At least one node with a positive tabindex was found in one of your focus-trap's multiple containers. Positive tabindexes are only supported in single-container focus-traps.")},h=function e(t){var n=t.activeElement;if(n)return n.shadowRoot&&null!==n.shadowRoot.activeElement?e(n.shadowRoot):n},p=function e(t){!1!==t&&t!==h(document)&&(t&&t.focus?(t.focus({preventScroll:!!o.preventScroll}),r.mostRecentlyFocusedNode=t,function(e){return e.tagName&&"input"===e.tagName.toLowerCase()&&"function"==typeof e.select}(t)&&t.select()):e(d()))},f=function(e){var t=l("setReturnFocus",e);return t||!1!==t&&e},g=function(e){var t=e.target,n=e.event,i=e.isBackward,s=void 0!==i&&i;t=t||ke(n),u();var a=null;if(r.tabbableGroups.length>0){var d=c(t,n),h=d>=0?r.containerGroups[d]:void 0;if(d<0)a=s?r.tabbableGroups[r.tabbableGroups.length-1].lastTabbableNode:r.tabbableGroups[0].firstTabbableNode;else if(s){var p=xe(r.tabbableGroups,(function(e){var n=e.firstTabbableNode;return t===n}));if(p<0&&(h.container===t||ue(t,o.tabbableOptions)&&!le(t,o.tabbableOptions)&&!h.nextTabbableNode(t,!1))&&(p=d),p>=0){var f=0===p?r.tabbableGroups.length-1:p-1,g=r.tabbableGroups[f];a=Z(t)>=0?g.lastTabbableNode:g.lastDomTabbableNode}else be(n)||(a=h.nextTabbableNode(t,!1))}else{var m=xe(r.tabbableGroups,(function(e){var n=e.lastTabbableNode;return t===n}));if(m<0&&(h.container===t||ue(t,o.tabbableOptions)&&!le(t,o.tabbableOptions)&&!h.nextTabbableNode(t))&&(m=d),m>=0){var b=m===r.tabbableGroups.length-1?0:m+1,y=r.tabbableGroups[b];a=Z(t)>=0?y.firstTabbableNode:y.firstDomTabbableNode}else be(n)||(a=h.nextTabbableNode(t))}}else a=l("fallbackFocus");return a},m=function(e){var t=ke(e);c(t,e)>=0||(Se(o.clickOutsideDeactivates,e)?n.deactivate({returnFocus:o.returnFocusOnDeactivate}):Se(o.allowOutsideClick,e)||e.preventDefault())},b=function(e){var t=ke(e),n=c(t,e)>=0;if(n||t instanceof Document)n&&(r.mostRecentlyFocusedNode=t);else{var i;e.stopImmediatePropagation();var s=!0;if(r.mostRecentlyFocusedNode)if(Z(r.mostRecentlyFocusedNode)>0){var a=c(r.mostRecentlyFocusedNode),l=r.containerGroups[a].tabbableNodes;if(l.length>0){var u=l.findIndex((function(e){return e===r.mostRecentlyFocusedNode}));u>=0&&(o.isKeyForward(r.recentNavEvent)?u+1<l.length&&(i=l[u+1],s=!1):u-1>=0&&(i=l[u-1],s=!1))}}else r.containerGroups.some((function(e){return e.tabbableNodes.some((function(e){return Z(e)>0}))}))||(s=!1);else s=!1;s&&(i=g({target:r.mostRecentlyFocusedNode,isBackward:o.isKeyBackward(r.recentNavEvent)})),p(i||(r.mostRecentlyFocusedNode||d()))}r.recentNavEvent=void 0},y=function(e){if(!(t=e,"Escape"!==(null==t?void 0:t.key)&&"Esc"!==(null==t?void 0:t.key)&&27!==(null==t?void 0:t.keyCode)||!1===Se(o.escapeDeactivates,e)))return e.preventDefault(),void n.deactivate();var t;(o.isKeyForward(e)||o.isKeyBackward(e))&&function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];r.recentNavEvent=e;var n=g({event:e,isBackward:t});n&&(be(e)&&e.preventDefault(),p(n))}(e,o.isKeyBackward(e))},v=function(e){var t=ke(e);c(t,e)>=0||Se(o.clickOutsideDeactivates,e)||Se(o.allowOutsideClick,e)||(e.preventDefault(),e.stopImmediatePropagation())},w=function(){if(r.active)return ge(s,n),r.delayInitialFocusTimer=o.delayInitialFocus?we((function(){p(d())})):p(d()),i.addEventListener("focusin",b,!0),i.addEventListener("mousedown",m,{capture:!0,passive:!1}),i.addEventListener("touchstart",m,{capture:!0,passive:!1}),i.addEventListener("click",v,{capture:!0,passive:!1}),i.addEventListener("keydown",y,{capture:!0,passive:!1}),n},x=function(){if(r.active)return i.removeEventListener("focusin",b,!0),i.removeEventListener("mousedown",m,!0),i.removeEventListener("touchstart",m,!0),i.removeEventListener("click",v,!0),i.removeEventListener("keydown",y,!0),n},S="undefined"!=typeof window&&"MutationObserver"in window?new MutationObserver((function(e){e.some((function(e){return Array.from(e.removedNodes).some((function(e){return e===r.mostRecentlyFocusedNode}))}))&&p(d())})):void 0,k=function(){S&&(S.disconnect(),r.active&&!r.paused&&r.containers.map((function(e){S.observe(e,{subtree:!0,childList:!0})})))};return(n={get active(){return r.active},get paused(){return r.paused},activate:function(e){if(r.active)return this;var t=a(e,"onActivate"),n=a(e,"onPostActivate"),s=a(e,"checkCanFocusTrap");s||u(),r.active=!0,r.paused=!1,r.nodeFocusedBeforeActivation=i.activeElement,null==t||t();var o=function(){s&&u(),w(),k(),null==n||n()};return s?(s(r.containers.concat()).then(o,o),this):(o(),this)},deactivate:function(e){if(!r.active)return this;var t=pe({onDeactivate:o.onDeactivate,onPostDeactivate:o.onPostDeactivate,checkCanReturnFocus:o.checkCanReturnFocus},e);clearTimeout(r.delayInitialFocusTimer),r.delayInitialFocusTimer=void 0,x(),r.active=!1,r.paused=!1,k(),me(s,n);var i=a(t,"onDeactivate"),c=a(t,"onPostDeactivate"),l=a(t,"checkCanReturnFocus"),d=a(t,"returnFocus","returnFocusOnDeactivate");null==i||i();var u=function(){we((function(){d&&p(f(r.nodeFocusedBeforeActivation)),null==c||c()}))};return d&&l?(l(f(r.nodeFocusedBeforeActivation)).then(u,u),this):(u(),this)},pause:function(e){if(r.paused||!r.active)return this;var t=a(e,"onPause"),n=a(e,"onPostPause");return r.paused=!0,null==t||t(),x(),k(),null==n||n(),this},unpause:function(e){if(!r.paused||!r.active)return this;var t=a(e,"onUnpause"),n=a(e,"onPostUnpause");return r.paused=!1,null==t||t(),u(),w(),k(),null==n||n(),this},updateContainerElements:function(e){var t=[].concat(e).filter(Boolean);return r.containers=t.map((function(e){return"string"==typeof e?i.querySelector(e):e})),r.active&&u(),k(),this}}).updateContainerElements(e),n};const Te=wp.i18n,Le=e=>{const t={};e.querySelectorAll("input, select, textarea").forEach((e=>{e.addEventListener("change",(()=>{document.dispatchEvent(new CustomEvent("edac-fix-settings-change"))}));const n=e.getAttribute("data-fix-slug");if(n)if(void 0===t[n]&&(t[n]={}),"checkbox"===e.type)t[n][e.name]=e.checked;else t[n][e.name]=e.value}));const n=e.querySelectorAll("button");n.forEach((e=>{e.disabled=!0})),e.classList.add("edac-fix-settings--saving");const i=e.querySelector("[aria-live]");i&&(i.innerText=(0,Te.__)("Saving...","accessibility-checker")),fetch("/wp-json/edac/v1/fixes/update/",{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":window.edacSettings?.nonce??window.edac_script_vars?.restNonce??window.edacFrontendHighlighterApp?.restNonce},body:JSON.stringify(t)}).then((t=>{if(e.classList.remove("edac-fix-settings--saving"),n.forEach((e=>{e.disabled=!1})),t.ok){if(e.classList.remove("edac-fix-settings--saved--error"),e.classList.add("edac-fix-settings--saved--success"),i){const e=window?.edacFrontendHighlighterApp?.editorLink||window?.edac_script_vars?.editorLink;e?i.innerHTML=(0,Te.sprintf)((0,Te.__)("Settings saved successfully. You must %svisit the editor%s and save the post to rescan and remove fixed issues from Accessibility Checker reports.","accessibility-checker"),`<a href="${e}">`,"</a>"):i.innerText=(0,Te.__)("Settings saved successfully.","accessibility-checker")}}else e.classList.add("edac-fix-settings--saved--error"),e.querySelector("[aria-live]").innerText=(0,Te.__)("Saving failed.","accessibility-checker");document.dispatchEvent(new CustomEvent("edac-fix-settings-saved",{detail:{success:t.ok}}))}))};let Ce=null;const Ae=new Event("edac-fixes-modal-closed",{bubbles:!0}),Ie=[],Fe=()=>{(()=>{const e=document.createElement("div");e.id="edac-fixes-modal",e.classList.add("edac-fixes-modal"),e.setAttribute("role","dialog"),e.setAttribute("aria-modal","false"),e.setAttribute("aria-labelledby","edac-fixes-modal-title"),e.innerHTML=`\n\t\t<div class="edac-fixes-modal__content">\n\t\t\t<div class="edac-fixes-modal__header">\n\t\t\t\t<h2 id="edac-fixes-modal-title">${(0,Te.__)("Fix Settings","accessibility-checker")}</h2>\n\t\t\t\t<button class="edac-fixes-modal__close" aria-label="${(0,Te.__)("Close fixes modal","accessibility-checker")}">\n\t\t\t\t\t<span class="dashicons dashicons-no-alt"></span>\n\t\t\t\t</button>\n\t\t\t</div>\n\t\t\t<div class="edac-fixes-modal__body">\n\t\t\t</div>\n\t\t</div>\n\t`;const t=document.createElement("div");t.classList.add("edac-fixes-modal__overlay"),t.setAttribute("aria-hidden","true"),t.setAttribute("tabindex","-1"),document.body.appendChild(t),document.body.appendChild(e)})(),document.querySelector(".edac-fixes-modal__close").addEventListener("click",(()=>{Ne()})),document.addEventListener("keydown",(e=>{document.activeElement.closest(".edac-fixes-modal")&&"Escape"===e.key&&Ne()}))},Ne=()=>{const e=document.getElementById("edac-fixes-modal");e.classList.remove("edac-fixes-modal--open"),e.setAttribute("aria-hidden","true"),e.setAttribute("aria-modal","false");const t=e.querySelector(".edac-fix-settings--clone--wrapper").children[0];document.querySelector(".edac-fix-settings--origin-placeholder").replaceWith(t);Array.from(document.body.children).forEach((e=>{"true"===e.getAttribute("data-hidden-by-modal")&&(e.removeAttribute("aria-hidden","false"),e.removeAttribute("data-hidden-by-modal","false"))})),document.body.classList.remove("edac-fixes-modal--open"),Ce&&Ce.focus(),De(),document.dispatchEvent(Ae)},De=()=>{Ie.forEach((({field:e,changeListener:t})=>{e.removeEventListener("change",t)}))};class Oe{constructor(e={}){this.settings={showIgnored:!1,...e},this._scanAttempted=!1,this._isRescanning=!1,this.highlightPanel=this.addHighlightPanel(),this.nextButton=document.querySelector("#edac-highlight-next"),this.previousButton=document.querySelector("#edac-highlight-previous"),this.panelToggle=document.querySelector("#edac-highlight-panel-toggle"),this.closePanel=document.querySelector("#edac-highlight-panel-controls-close"),this.panelDescription=document.querySelector("#edac-highlight-panel-description"),this.panelControls=document.querySelector("#edac-highlight-panel-controls"),this.descriptionCloseButton=document.querySelector(".edac-highlight-panel-description-close"),this.issues=null,this.fixes=null,this.currentButtonIndex=null,this.urlParameter=this.get_url_parameter("edac"),this.landmarkParameter=this.get_url_parameter("edac_landmark"),this.currentIssueStatus=null,this.tooltips=[],this.panelControlsFocusTrap=_e("#"+this.panelControls.id,{clickOutsideDeactivates:!0,escapeDeactivates:()=>{this.panelClose()}}),this.panelDescriptionFocusTrap=_e("#"+this.panelDescription.id,{clickOutsideDeactivates:!0,escapeDeactivates:()=>{this.descriptionClose()}}),this.disableStylesButton=document.querySelector("#edac-highlight-disable-styles"),this.rescanButton=document.querySelector("#edac-highlight-rescan"),this.clearIssuesButton=document.querySelector("#edac-highlight-clear-issues"),this.stylesDisabled=!1,this.originalCss=[],this.originalInlineStyles=[],this.init()}init(){this.nextButton.addEventListener("click",(()=>{this.highlightFocusNext(),this.focusTrapDescription()})),this.previousButton.addEventListener("click",(()=>{this.highlightFocusPrevious(),this.focusTrapDescription()})),this.panelToggle.addEventListener("click",(()=>{this.panelOpen(),this.focusTrapControls()})),this.closePanel.addEventListener("click",(()=>{this.panelClose(),this.panelControlsFocusTrap.deactivate(),this.panelDescriptionFocusTrap.deactivate(),this.stylesDisabled&&this.enableStyles()})),this.descriptionCloseButton.addEventListener("click",(()=>this.descriptionClose())),this.disableStylesButton.addEventListener("click",(()=>{this.stylesDisabled?this.enableStyles():this.disableStyles()})),this.rescanButton&&this.rescanButton.addEventListener("click",(()=>{this.rescanPage()})),this.clearIssuesButton&&this.clearIssuesButton.addEventListener("click",(()=>{this.clearIssues()})),this.urlParameter?this.panelOpen(this.urlParameter):this.landmarkParameter&&this.highlightLandmark(this.landmarkParameter)}findElement(e,t){if(e.selector)try{const n=document.querySelector(e.selector);if(n){const i=this.addTooltip(n,e,t,this.issues.length);return this.issues[t].tooltip=i.tooltip,this.tooltips.push(i),n}}catch(e){}if(e.ancestry)try{const n=document.querySelector(e.ancestry);if(n){const i=this.addTooltip(n,e,t,this.issues.length);return this.issues[t].tooltip=i.tooltip,this.tooltips.push(i),n}}catch(e){}let n=e.object;const i=(new DOMParser).parseFromString(n,"text/html").body.firstElementChild;i&&(n=i.outerHTML);const s=document.body.querySelectorAll("*");for(const i of s)if(i.outerHTML.replace(/\W/g,"")===n.replace(/\W/g,"")){const n=this.addTooltip(i,e,t,this.issues.length);return this.issues[t].tooltip=n.tooltip,this.tooltips.push(n),i}return null}highlightAjax(){const e=this;return new Promise((function(t,n){const i=new XMLHttpRequest,s=edacFrontendHighlighterApp.ajaxurl+"?action=edac_frontend_highlight_ajax&post_id="+edacFrontendHighlighterApp.postID+"&nonce="+edacFrontendHighlighterApp.nonce;e.showWait(!0),i.open("GET",s),i.onload=function(){if(200===i.status){e.showWait(!1);const s=JSON.parse(i.responseText);if(!0===s.success){const n=JSON.parse(s.data);e.settings.showIgnored?t({issues:n.issues,fixes:n.fixes}):t({issues:n.issues.filter((t=>null!==t.rule_type&&(t.id===e.urlParameter||"ignored"!==t.rule_type))),fixes:n.fixes})}else e._scanAttempted||-3!==s.data?.[0]?.code?t({issues:[],fixes:[]}):(e._scanAttempted=!0,e.kickoffScan(),setTimeout((()=>{e.highlightAjax().then(t).catch(n)}),5e3))}else e.showWait(!1),n({status:i.status,statusText:i.statusText})},i.onerror=function(){e.showWait(!1),n({status:i.status,statusText:i.statusText})},i.send()}))}showWait(e=!0){e?document.querySelector("body").classList.add("edac-app-wait"):document.querySelector("body").classList.remove("edac-app-wait")}removeHighlightButtons(){this.tooltips.forEach((e=>{e.tooltip.removeEventListener("click",e.listeners.onClick),e.listeners.cleanup()}));document.querySelectorAll(".edac-highlight-btn").forEach((e=>{e.remove()})),this.removeLandmarkLabels()}addTooltip(e,t,n,i){const s=document.createElement("button");s.classList="edac-highlight-btn edac-highlight-btn-"+t.rule_type,s.setAttribute("aria-label",(0,Te.sprintf)((0,Te.__)("Open details for %1$s, %2$s of %3$s","accessibility-checker"),t.rule_title,n+1,i)),s.setAttribute("aria-expanded","false"),s.setAttribute("aria-haspopup","dialog"),s.dataset.id=t.id;const o=e=>{const t=e.currentTarget.dataset.id;this.showIssue(t)};s.addEventListener("click",o),document.body.append(s),e.__edacElementId||(e.__edacElementId="edac-"+Math.random().toString(36).substr(2,9)),s.dataset.targetElement=e.__edacElementId,s.dataset.creationOrder=Date.now()+Math.random();const r=j(e,s,(function(){const t=parseInt(s.dataset.sortedIndex||"0",10),n=s.dataset.targetElement;let i=0;const o=Array.from(document.querySelectorAll(".edac-highlight-btn"));for(const e of o){if(e===s)break;const o=parseInt(e.dataset.sortedIndex||"0",10);e.dataset.targetElement===n&&o<t&&i++}W(e,s,{placement:"top-start",middleware:[]}).then((({x:t,y:n})=>{const o=e.getBoundingClientRect(),r=void 0===e.offsetHeight?0:e.offsetHeight,a=void 0===s.offsetHeight?0:s.offsetHeight,c=void 0===s.offsetWidth?0:s.offsetWidth,l=t+i*(c+5);let d=n;0===r&&0===o.height&&(d=o.top+document.documentElement.scrollTop-a-5),Object.assign(s.style,{left:`${l}px`,top:`${d}px`})}))}),{ancestorScroll:!0,ancestorResize:!0,elementResize:!0,layoutShift:!0,animationFrame:!0});return{element:e,tooltip:s,listeners:{onClick:o,cleanup:r}}}addHighlightPanel(){const e=edacFrontendHighlighterApp?.widgetPosition||"right",t=edacFrontendHighlighterApp&&edacFrontendHighlighterApp?.userCanEdit&&edacFrontendHighlighterApp?.loggedIn,n=t?`<button id="edac-highlight-clear-issues" class="edac-highlight-clear-issues">${(0,Te.__)("Clear Issues","accessibility-checker")}</button>`:"",i=t?`<button id="edac-highlight-rescan" class="edac-highlight-rescan">${(0,Te.__)("Rescan This Page","accessibility-checker")}</button>`:"",s=`\n                        <div id="edac-highlight-panel" class="edac-highlight-panel edac-highlight-panel--${e}">\n                                <button id="edac-highlight-panel-toggle" class="edac-highlight-panel-toggle" aria-haspopup="dialog" aria-label="${(0,Te.__)("Accessibility Checker Tools","accessibility-checker")}"></button>\n                                <div id="edac-highlight-panel-description" class="edac-highlight-panel-description" role="dialog" aria-labelledby="edac-highlight-panel-description-title" tabindex="0">\n                                <button class="edac-highlight-panel-description-close edac-highlight-panel-controls-close" aria-label="${(0,Te.__)("Close","accessibility-checker")}">×</button>\n                                        <div id="edac-highlight-panel-description-title" class="edac-highlight-panel-description-title"></div>\n                                        <div class="edac-highlight-panel-description-content"></div>\n                                        <div id="edac-highlight-panel-description-code" class="edac-highlight-panel-description-code"><code></code></div>\n                                </div>\n                                <div id="edac-highlight-panel-controls" class="edac-highlight-panel-controls" tabindex="0">\n                                <button id="edac-highlight-panel-controls-close" class="edac-highlight-panel-controls-close" aria-label="${(0,Te.__)("Close","accessibility-checker")}">×</button>\n                                <div class="edac-highlight-panel-controls-title">${(0,Te.__)("Accessibility Checker","accessibility-checker")}</div>\n                                <div class="edac-highlight-panel-controls-summary">${(0,Te.__)("Loading...","accessibility-checker")}</div>\n                                <div class="edac-highlight-panel-controls-buttons ${t?"":" single_button"}">\n                                        <div>\n                                                <button id="edac-highlight-previous" disabled="true"><span aria-hidden="true">« </span>${(0,Te.__)("Previous","accessibility-checker")}</button>\n                                                <button id="edac-highlight-next" disabled="true">${(0,Te.__)("Next","accessibility-checker")}<span aria-hidden="true"> »</span></button><br />\n                                        </div>\n                                        <div>\n                                                ${i}\n                                                ${n}\n                                                <button id="edac-highlight-disable-styles" class="edac-highlight-disable-styles" aria-live="polite" aria-label="${(0,Te.__)("Disable Page Styles","accessibility-checker")}">${(0,Te.__)("Disable Styles","accessibility-checker")}</button>\n                                        </div>\n                                </div>\n                        </div>\n                        </div>\n                `;return document.body.insertAdjacentHTML("afterbegin",s),document.getElementById("edac-highlight-panel")}highlightFocusNext=()=>{null===this.currentButtonIndex?this.currentButtonIndex=0:this.currentButtonIndex=(this.currentButtonIndex+1)%this.issues.length;const e=this.issues[this.currentButtonIndex].id;this.showIssue(e)};highlightFocusPrevious=()=>{null===this.currentButtonIndex?this.currentButtonIndex=this.issues.length-1:this.currentButtonIndex=(this.currentButtonIndex-1+this.issues.length)%this.issues.length;const e=this.issues[this.currentButtonIndex].id;this.showIssue(e)};focusTrapControls=()=>{this.panelDescriptionFocusTrap.deactivate(),this.panelControlsFocusTrap.activate(),setTimeout((()=>{this.panelControls.focus()}),100)};focusTrapDescription=()=>{this.panelControlsFocusTrap.deactivate(),this.panelDescriptionFocusTrap.activate(),setTimeout((()=>{this.panelDescription.focus()}),100)};showIssue=e=>{if(this.removeSelectedClasses(),void 0===e)return;const t=this.issues.find((t=>t.id===e));this.currentButtonIndex=this.issues.findIndex((t=>t.id===e));const n=t.tooltip,i=t.element;n&&i?(n.classList.add("edac-highlight-btn-selected"),i.classList.add("edac-highlight-element-selected"),i.offsetWidth<20&&i.classList.add("edac-highlight-element-selected-min-width"),i.offsetHeight<5&&i.classList.add("edac-highlight-element-selected-min-height"),i.scrollIntoView({block:"center"}),ue(n)?this.checkVisibility(n)&&this.checkVisibility(i)?this.currentIssueStatus=null:this.currentIssueStatus=(0,Te.__)("The element is not visible. Try disabling styles.","accessibility-checker"):this.currentIssueStatus=(0,Te.__)("The element is not focusable. Try disabling styles.","accessibility-checker")):this.currentIssueStatus=(0,Te.__)("The element was not found on the page.","accessibility-checker"),this.descriptionOpen(e)};checkVisibility=e=>"function"!=typeof e.checkVisibility?!!(e.offsetWidth||e.offsetHeight||e.getClientRects().length):e.checkVisibility({checkOpacity:!0,checkVisibilityCSS:!0});panelOpen(e){this.highlightPanel.classList.add("edac-highlight-panel-visible"),this.panelControls.style.display="block",this.panelToggle.style.display="none",this.nextButton.disabled=!0,this.previousButton.disabled=!0,this.highlightAjax().then((t=>{this.issues=t.issues,this.fixes=t.fixes,t.issues.forEach(function(e,t){const n=this.findElement(e,t);null!==n&&(this.issues[t].element=n)}.bind(this)),this.issues.sort(((e,t)=>{if(!e.element&&t.element)return 1;if(e.element&&!t.element)return-1;if(!e.element&&!t.element)return 0;const n=e.element.compareDocumentPosition(t.element);if(n&Node.DOCUMENT_POSITION_FOLLOWING)return-1;if(n&Node.DOCUMENT_POSITION_PRECEDING)return 1;return parseInt(e.id,10)-parseInt(t.id,10)})),this.issues.forEach(((e,t)=>{e.tooltip&&(e.tooltip.dataset.sortedIndex=t,e.tooltip.setAttribute("aria-label",(0,Te.sprintf)((0,Te.__)("Open details for %1$s, %2$s of %3$s","accessibility-checker"),e.rule_title,t+1,this.issues.length)))})),this.showIssueCount(),void 0!==e&&(this.showIssue(e),this.focusTrapDescription())})).catch((e=>{const t=document.querySelector(".edac-highlight-panel-controls-summary");t&&(t.textContent=(0,Te.__)("An error occurred when loading the issues.","accessibility-checker"))}))}panelClose(){this.highlightPanel.classList.remove("edac-highlight-panel-visible"),this.panelControls.style.display="none",this.panelDescription.style.display="none",this.panelToggle.style.display="block",this.removeSelectedClasses(),this.removeHighlightButtons(),this.closePanel.removeEventListener("click",this.panelControlsFocusTrap.deactivate),this.panelToggle.focus()}removeSelectedClasses=()=>{document.querySelectorAll(".edac-highlight-btn-selected").forEach((e=>{e.classList.remove("edac-highlight-btn-selected")}));document.querySelectorAll(".edac-highlight-element-selected").forEach((e=>{e.classList.remove("edac-highlight-element-selected","edac-highlight-element-selected-min-width","edac-highlight-element-selected-min-height"),0===e.classList.length&&e.removeAttribute("class")})),this.removeLandmarkLabels()};descriptionOpen(e){const t=e,n=this.issues.find((e=>e.id===t));if(n){const e=document.querySelector(".edac-highlight-panel-description-title"),t=document.querySelector(".edac-highlight-panel-description-content"),i=document.querySelector(".edac-highlight-panel-description-code code");let s="";s+=` <div class="edac-highlight-panel-description-index">${this.currentButtonIndex+1} of ${this.issues.length}</div>`,this.currentIssueStatus&&(s+=` <div class="edac-highlight-panel-description-status">${this.currentIssueStatus}</div>`),n.summary&&(s+=`<p class="edac-highlight-panel-description-summary">${n.summary}</p>`),n.how_to_fix&&(s+=`<div class="edac-highlight-panel-description-how-to-fix">\n\t\t\t\t\t<div class="edac-highlight-panel-description-how-to-fix-title">How to fix it:</div>\n\t\t\t\t\t<p class="edac-highlight-panel-description-how-to-fix-content">${n.how_to_fix}</p>\n\t\t\t\t</div>`),this.fixes[n.slug]&&window.edacFrontendHighlighterApp?.userCanFix?(s+=`\n\t\t\t\t\t<div style="display:none;" class="always-hide">\n\t\t\t\t\t\t<div class="edac-fix-settings">\n\t\t\t\t\t\t\t<div class="edac-fix-settings--fields">\n\t\t\t\t\t\t\t\t${this.fixes[n.slug].fields}\n\t\t\t\t\t\t\t\t<div class="edac-fix-settings--action-row">\n\t\t\t\t\t\t\t\t\t<button role="button" class="button button-primary edac-fix-settings--button--save">\n\t\t\t\t\t\t\t\t\t\t${(0,Te.__)("Save","accessibility-checker")}\n\t\t\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t\t\t<span class="edac-fix-settings--notice-slot" aria-live="polite" role="alert"></span>\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t`,s+=` <br />\n \t\t\t\t\t<button role="button"\n \t\t\t\t\t\tclass="edac-fix-settings--button--open edac-highlight-panel-description--button"\n \t\t\t\t\t\taria-haspopup="true"\n \t\t\t\t\t\taria-controls="edac-highlight-panel-description-fix"\n\t\t\t\t\t\taria-label="${(0,Te.sprintf)((0,Te.__)("Fix issue: %s","accessibility-checker"),this.fixes[n.slug][Object.keys(this.fixes[n.slug])[0]].group_name)}"> \t\t\t\t\t\t${(0,Te.__)("Fix Issue","accessibility-checker")}</button>`):s+=" <br />",s+=`<a class="edac-highlight-panel-description-reference" href="${n.link}">${(0,Te.__)("Full Documentation","accessibility-checker")}</a>`,s+=`<button class="edac-highlight-panel-description-code-button" aria-expanded="false" aria-controls="edac-highlight-panel-description-code">${(0,Te.__)("Show Code","accessibility-checker")}</button>`,e.innerHTML=n.rule_title+' <span class="edac-highlight-panel-description-type edac-highlight-panel-description-type-'+n.rule_type+'" aria-label="'+(0,Te.__)("Issue type:","accessibility-checker")+" "+n.rule_type+'"> '+n.rule_type+"</span>",t.innerHTML=s;const o=n.object,r=(new DOMParser).parseFromString(o,"text/html").body.firstElementChild;if(r)i.innerText=r.outerHTML;else{const e=document.createTextNode(n.object);i.innerText=e.nodeValue}this.fixes[n.slug]&&window.edacFrontendHighlighterApp?.userCanFix&&(this.fixSettingsButton=document.querySelector(".edac-fix-settings--button--open"),this.fixSettingsButton.addEventListener("click",(e=>{this.showFixSettings(e)})),this.fixSettingsButton.display="block",this.fixSettingsSaveButton=document.querySelector(".edac-fix-settings--button--save"),this.fixSettingsSaveButton.addEventListener("click",(e=>{Le(e.target.closest(".edac-fix-settings"))}))),this.codeContainer=document.querySelector(".edac-highlight-panel-description-code"),this.codeButton=document.querySelector(".edac-highlight-panel-description-code-button"),this.codeButton.addEventListener("click",(()=>this.codeToggle())),this.codeContainer.style.display="none",this.panelDescription.style.display="block"}}descriptionClose(){this.panelDescription.style.display="none",this.focusTrapControls()}disableStyles(){if(!document.querySelector("#edac-app-css")){const e=document.createElement("link");e.rel="stylesheet",e.id="edac-app-css",e.type="text/css",e.href=edacFrontendHighlighterApp.appCssUrl,e.media="all",document.head.appendChild(e)}this.originalInlineStyles=[];document.querySelectorAll('*[style]:not([class^="edac"])').forEach((e=>{this.originalInlineStyles.push({element:e,style:e.getAttribute("style")}),e.removeAttribute("style")}));const e=Array.from(document.querySelectorAll('style[type="text/css"], style, link[rel="stylesheet"], link[href$=".css"], link[href*=".css?"]'));this.originalCss=e.filter((e=>"edac-app-css"!==e.id&&"dashicons-css"!==e.id)).map((e=>{const t=e.parentNode;let n=e.nextElementSibling;for(;n;){const e="STYLE"===n.tagName,t="LINK"===n.tagName&&(n.matches('[rel="stylesheet"]')||n.matches('[href$=".css"]')||n.matches('[href*=".css?"]')),i="edac-app-css"===n.id||"dashicons-css"===n.id;if(!e&&!t||i)break;n=n.nextElementSibling}return{element:e,parent:t,nextSibling:n}})),this.originalCss.forEach((e=>{e.element.remove()})),document.querySelector("body").classList.add("edac-app-disable-styles"),this.stylesDisabled=!0,this.disableStylesButton.textContent=(0,Te.__)("Enable Styles","accessibility-checker")}enableStyles(){[...this.originalCss].reverse().forEach((e=>{const t=e.parent&&e.parent.isConnected?e.parent:document.head;e.nextSibling&&e.nextSibling.parentNode===t?t.insertBefore(e.element,e.nextSibling):t.appendChild(e.element)})),this.originalInlineStyles&&this.originalInlineStyles.forEach((e=>{e.element&&e.element.isConnected&&e.element.setAttribute("style",e.style)})),document.querySelector("body").classList.remove("edac-app-disable-styles"),this.stylesDisabled=!1,this.disableStylesButton.textContent=(0,Te.__)("Disable Styles","accessibility-checker")}get_url_parameter(e){const t=window.location.search.substring(1).split("&");let n,i;for(i=0;i<t.length;i++)if(n=t[i].split("="),n[0]===e)return void 0===n[1]||decodeURIComponent(n[1]);return!1}codeToggle(){"none"===this.codeContainer.style.display||""===this.codeContainer.style.display?(this.codeContainer.style.display="block",this.codeButton.setAttribute("aria-expanded","true")):(this.codeContainer.style.display="none",this.codeButton.setAttribute("aria-expanded","false"))}showFixSettings(e){const t=e.target.closest(".edac-highlight-panel-description-content").querySelector(".edac-fix-settings");if(!t)return;const n=document.createElement("span");n.classList.add("edac-fix-settings--origin-placeholder"),t.parentNode.insertBefore(n,t),t.remove(),((e="",t="")=>{""===t&&((t=document.createElement("p")).innerText=(0,Te.__)("There are no settings to display.","accessibility-checker"));const n=document.createElement("div");n.classList.add("edac-fix-settings--clone--wrapper"),n.appendChild(t);let i=n.querySelector("[data-fancy-name]")?.getAttribute("data-fancy-name")||"";""===i&&(i=n.querySelector("[data-group-name]")?.getAttribute("data-group-name")||"");const s=document.getElementById("edac-fixes-modal"),o=s.querySelector("#edac-fixes-modal-title"),r=s.querySelector(".edac-fixes-modal__body");o.innerText=i,r.innerHTML=e,r.appendChild(n),s.querySelectorAll("input, select, textarea").forEach((e=>{const t=()=>{document.dispatchEvent(new CustomEvent("edac-fix-settings-change"))};e.addEventListener("change",t),Ie.push({field:e,changeListener:t})})),s.querySelector(".edac-fix-settings--button--save").addEventListener("click",(()=>{Le(r.querySelector(".edac-fix-settings--fields"))})),document.addEventListener("edac-fix-settings-change",(()=>{s.querySelector("[aria-live]").innerText=""}))})(`<p class="modal-opening-message">${(0,Te.__)("These settings enable global fixes across your entire site. Pages may need to be resaved or a full site scan run to see fixes reflected in reports.","accessibility-checker")}</p>`,t),this.panelDescriptionFocusTrap.pause(),(e=>{const t=document.getElementById("edac-fixes-modal");t.classList.add("edac-fixes-modal--open"),t.setAttribute("aria-hidden","false"),t.setAttribute("aria-modal","true"),Array.from(document.body.children).forEach((e=>{"edac-fixes-modal"===e.id||e.classList.contains("edac-fixes-modal__overlay")||!0!==e.getAttribute("aria-hidden")&&(e.setAttribute("aria-hidden","true"),e.setAttribute("data-hidden-by-modal","true"))})),document.body.classList.add("edac-fixes-modal--open"),Ce=e;const n=t.querySelector(".edac-fixes-modal__body").querySelector('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])');n&&setTimeout((()=>{n.focus()}),100),t.addEventListener("keydown",(e=>{if("Tab"===e.key){const n=t.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),i=n[0],s=n[n.length-1];e.shiftKey&&document.activeElement===i?(e.preventDefault(),s.focus()):e.shiftKey||document.activeElement!==s||(e.preventDefault(),i.focus())}}))})(e.target),document.addEventListener("edac-fixes-modal-closed",(()=>{this.panelDescriptionFocusTrap.unpause()}))}countIssues(e){let t=0;for(const n of this.issues)n.rule_type===e&&t++;return t}countIgnored(){let e=0;for(const t of this.issues)"1"===t.ignored&&e++;return e}showIssueCount(){const e=this.countIssues("error"),t=this.countIssues("warning"),n=this.countIgnored(),i=document.querySelector(".edac-highlight-panel-controls-summary");let s=(0,Te.__)("No issues detected.","accessibility-checker");(e>0||t>0||n>0)&&(s="",this.nextButton.disabled=!1,this.previousButton.disabled=!1,e>=0&&(s+=e+" "+(0,Te._n)("error","errors",e,"accessibility-checker")+", "),t>=0&&(s+=t+" "+(0,Te._n)("warning","warnings",t,"accessibility-checker")+", "),n>0?s+=(0,Te.__)("and","accessibility-checker")+" "+n+" "+(0,Te._n)("ignored issue","ignored issues",n,"accessibility-checker")+" "+(0,Te.__)("detected.","accessibility-checker"):s=s.slice(0,-2)+" "+(0,Te.__)("detected.","accessibility-checker")),i.textContent=s}highlightLandmark(e){try{const t=atob(e);let n=null;try{n=document.querySelector(t)}catch(e){}if(!n){const e=[t.replace(/:nth-child\(\d+\)/g,"").replace(/\s+>\s+/g," "),t.split(" > ").pop(),t.replace(/\.[^:\s>]+/g,"")];for(const t of e)if(t&&t.trim())try{if(n=document.querySelector(t.trim()),n)break}catch(e){}}if(n){this.removeLandmarkLabels(),n.classList.add("edac-highlight-element-selected"),n.classList.add("edac-landmark-highlight");const e=this.getLandmarkType(n),t=document.createElement("div");t.classList.add("edac-landmark-label"),t.textContent=(0,Te.sprintf)((0,Te.__)("Landmark: %s","accessibility-checker"),e),t.setAttribute("aria-hidden","true"),t.style.cssText="\n\t\t\t\t\tposition: absolute;\n\t\t\t\t\tbackground: #072446;\n\t\t\t\t\tcolor: white;\n\t\t\t\t\tpadding: 4px 8px;\n\t\t\t\t\tfont-size: 12px;\n\t\t\t\t\tfont-weight: bold;\n\t\t\t\t\tborder-radius: 3px;\n\t\t\t\t\tz-index: 99998;\n\t\t\t\t\tpointer-events: none;\n\t\t\t\t\tfont-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n\t\t\t\t\tline-height: 1;\n\t\t\t\t\tbox-shadow: 0 2px 4px rgba(0,0,0,0.2);\n\t\t\t\t";const i=n.getBoundingClientRect();t.style.left=i.left+window.scrollX-0+"px",t.style.top=i.top+window.scrollY-0+"px",document.body.appendChild(t),n.setAttribute("data-edac-landmark-label-id",Date.now()),t.setAttribute("data-edac-landmark-for",n.getAttribute("data-edac-landmark-label-id")),n.offsetWidth<20&&n.classList.add("edac-highlight-element-selected-min-width"),n.offsetHeight<5&&n.classList.add("edac-highlight-element-selected-min-height");const s=n.getBoundingClientRect().top+window.scrollY-75;window.scrollTo({top:s,behavior:"smooth"})}}catch(e){}}getLandmarkType(e){const t=e.getAttribute("role");if(t)switch(t.toLowerCase()){case"banner":return"Header";case"navigation":return"Navigation";case"main":return"Main";case"complementary":return"Complementary";case"contentinfo":return"Footer";case"search":return"Search";case"form":return"Form";case"region":return"Region";default:return t.charAt(0).toUpperCase()+t.slice(1)}switch(e.tagName.toLowerCase()){case"header":return"Header";case"nav":return"Navigation";case"main":return"Main";case"aside":return"Complementary";case"footer":return"Footer";case"section":return e.getAttribute("aria-label")||e.getAttribute("aria-labelledby")||e.querySelector("h1, h2, h3, h4, h5, h6")?"Region":"Section";case"form":return e.getAttribute("aria-label")||e.getAttribute("aria-labelledby")?"Form":"Form (unlabeled)";default:return"Landmark"}}removeLandmarkLabels(){document.querySelectorAll(".edac-landmark-label").forEach((e=>{e.remove()}));document.querySelectorAll(".edac-landmark-highlight").forEach((e=>{e.classList.remove("edac-landmark-highlight"),e.removeAttribute("data-edac-landmark-label-id")}))}kickoffScan(){const e={elementCount:document.body.getElementsByTagName("*").length,contentLength:document.body.innerText.length},t=this,n="edac-accessibility-checker-scanner-script";if(document.getElementById(n))t._runScanOrShowError(e);else{const i=document.createElement("script");i.src=window.edacFrontendHighlighterApp?.scannerBundleUrl||"/wp-content/plugins/accessibility-checker/build/pageScanner.bundle.js",i.id=n,i.onload=function(){setTimeout((()=>{t._runScanOrShowError(e)}),100)},i.onerror=function(){t.showWait(!1),t.showScanError("Failed to load scanner script.")},document.head.appendChild(i)}}_runScanOrShowError(e){window.runAccessibilityScan?this.runAccessibilityScanAndSave(e):(this.showWait(!1),this.showScanError((0,Te.__)("Scanner function not found.","accessibility-checker")))}runAccessibilityScanAndSave(e){const t=this,n=document.querySelector(".edac-highlight-panel-controls-summary");n&&(n.textContent=(0,Te.__)("Scanning...","accessibility-checker"),n.classList.remove("edac-error")),window.runAccessibilityScan().then((n=>{const i=window.edacFrontendHighlighterApp&&window.edacFrontendHighlighterApp.postID,s=window.edacFrontendHighlighterApp&&window.edacFrontendHighlighterApp.restNonce;return i&&s?n&&n.violations&&0!==n.violations.length?void t.saveScanResults(i,s,n.violations,e):(t.showWait(!1),void t.showScanError((0,Te.__)("No violations found, skipping save.","accessibility-checker"))):(t.showWait(!1),void t.showScanError((0,Te.__)("Missing postId or nonce.","accessibility-checker")))})).catch((()=>{t.showWait(!1),t.showScanError((0,Te.__)("Accessibility scan error.","accessibility-checker"))}))}saveScanResults(e,t,n,i){const s=this;fetch("/wp-json/accessibility-checker/v1/post-scan-results/"+e,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":t},body:JSON.stringify({violations:n,isSkipped:!1,isFailure:!1,densityMetrics:i})}).then((e=>e.json())).then((e=>{s.showWait(!1),e&&e.success||s.showScanError((0,Te.__)("Saving failed.","accessibility-checker"))})).catch((()=>{s.showWait(!1),s.showScanError((0,Te.__)("Error saving scan results.","accessibility-checker"))}))}rescanPage(){this._isRescanning||(this._isRescanning=!0,this.removeHighlightButtons(),this.kickoffScan(),setTimeout((()=>{this._isRescanning=!1,this.panelOpen()}),5e3))}clearIssues(){if(!confirm((0,Te.__)("This will clear all issues for this post. A save will be required to trigger a fresh scan of the post content. Do you want to continue?","accessibility-checker")))return;if(!this.clearIssuesButton)return;if(!edacFrontendHighlighterApp?.edacUrl||!edacFrontendHighlighterApp?.postID){const e=document.querySelector(".edac-highlight-panel-controls-summary");return void(e&&(e.textContent=(0,Te.__)("Error: Missing required parameters.","accessibility-checker"),e.classList.add("edac-error")))}this.clearIssuesButton.disabled=!0,this.clearIssuesButton.textContent=(0,Te.__)("Clearing...","accessibility-checker");const e=document.querySelector(".edac-highlight-panel-controls-summary");fetch(`${edacFrontendHighlighterApp.edacUrl}/wp-json/accessibility-checker/v1/clear-issues/${edacFrontendHighlighterApp.postID}`,{method:"POST",headers:{"Content-Type":"application/json","X-WP-Nonce":edacFrontendHighlighterApp.restNonce},body:JSON.stringify({id:edacFrontendHighlighterApp.postID,flush:!0})}).then((t=>{t.ok?(this.removeHighlightButtons(),this.issues=[],this.showIssueCount(),e&&(e.textContent=(0,Te.__)("Issues cleared successfully.","accessibility-checker"),e.classList.remove("edac-error"))):e&&(e.textContent=(0,Te.__)("Failed to clear issues.","accessibility-checker"),e.classList.add("edac-error"))})).catch((()=>{e&&(e.textContent=(0,Te.__)("An error occurred while clearing issues.","accessibility-checker"),e.classList.add("edac-error"))})).finally((()=>{this.clearIssuesButton.disabled=!1,this.clearIssuesButton.textContent=(0,Te.__)("Clear Issues","accessibility-checker")}))}showScanError(e){const t=document.querySelector(".edac-highlight-panel-controls-summary");t&&(t.textContent=e,t.classList.add("edac-error"))}}let Be=!1;const Re=()=>{Be||(new Oe,window.edacFrontendHighlighterApp?.userCanFix&&Fe(),Be=!0)};["DOMContentLoaded","load"].forEach((e=>{window.addEventListener(e,Re)}))})()})();